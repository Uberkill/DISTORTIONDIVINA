<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DISTORTION CORP // SECURE TERMINAL</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Share+Tech+Mono&family=Noto+Sans+JP:wght@400;700&family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #050505;
            --gold-primary: #D4AF37;
            --gold-dim: #8a7020;
            --terminal-green: #33ff00;
            --glitch-red: #ff003c;
            --glitch-blue: #00f0ff;
            --window-bg: rgba(12, 12, 12, 0.90);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            cursor: default;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        *:focus-visible {
            outline: 1px solid var(--terminal-green);
            outline-offset: 2px;
        }

        body {
            background-color: var(--bg-color);
            color: var(--gold-primary);
            font-family: 'Share Tech Mono', 'Noto Sans KR', 'Noto Sans JP', monospace;
            overflow: hidden; 
            height: 100vh;
            width: 100vw;
            perspective: 1000px;
            font-size: 16px;
        }

        /* --- LOADING & SKELETON STYLES --- */
        #system-loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 20000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 0.5s ease;
        }
        
        .loader-spinner {
            width: 50px; height: 50px;
            border: 3px solid rgba(212, 175, 55, 0.2);
            border-top-color: var(--gold-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.1);
        }
        
        .loader-text {
            font-family: 'Share Tech Mono';
            color: var(--gold-dim);
            font-size: 0.9rem;
            letter-spacing: 2px;
            animation: pulse-text 1.5s infinite;
        }

        @keyframes spin { 100% { transform: rotate(360deg); } }
        @keyframes pulse-text { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }

        /* Skeleton Loading Effect */
        .skeleton {
            background: linear-gradient(90deg, rgba(255,255,255,0.02) 25%, rgba(255,255,255,0.08) 50%, rgba(255,255,255,0.02) 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
            border-radius: 2px;
            border: 1px solid rgba(255,255,255,0.05) !important;
        }
        @keyframes shimmer { 
            0% { background-position: 200% 0; } 
            100% { background-position: -200% 0; } 
        }

        /* Ripple Effect */
        .ripple {
            position: absolute; border-radius: 50%;
            transform: scale(0); animation: ripple 0.6s linear;
            background-color: rgba(255, 255, 255, 0.2);
            pointer-events: none;
        }
        @keyframes ripple { to { transform: scale(4); opacity: 0; } }

        /* Button/Interactive element relative positioning for ripple */
        button, .desktop-icon, .card-file, .shop-link-btn {
            position: relative;
            overflow: hidden;
        }

        /* Auto-Login Progress Bar */
        .login-progress-track {
            width: 100%; height: 2px; background: rgba(255,255,255,0.1);
            margin-top: 20px; position: relative; overflow: hidden;
        }
        .login-progress-bar {
            width: 0%; height: 100%; background: var(--gold-primary);
            transition: width 0.1s linear; /* Smooth controlled update */
            box-shadow: 0 0 10px var(--gold-primary);
        }

        /* --- CONTAINER FOR ROTATION --- */
        #app-container {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            transition: transform 0.5s ease, width 0.5s ease, height 0.5s ease;
            transform-origin: center center;
        }

        #app-container.rotated {
            width: 100vh;
            height: 100vw;
            transform: rotate(90deg) translate((50vw - 50vh), (50vh - 50vw));
            position: fixed;
            top: 50%;
            left: 50%;
            translate: -50% -50%;
        }

        /* --- VISUAL EFFECTS --- */
        .crt-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 9999;
            background: 
                linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%),
                linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
            background-size: 100% 4px, 3px 100%;
            animation: flicker 0.03s infinite;
            opacity: 0.6;
        }

        .vignette {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 9998;
            background: radial-gradient(circle, rgba(0,0,0,0) 60%, rgba(0,0,0,0.8) 150%);
        }

        body { text-shadow: 0 0 2px rgba(212, 175, 55, 0.3); }

        /* --- MODE SWITCH BUTTON --- */
        .mode-switch-btn, .ui-scale-btn {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid var(--terminal-green);
            color: var(--terminal-green);
            font-size: 0.9rem;
            padding: 8px 16px;
            cursor: pointer;
            font-family: 'Share Tech Mono';
            margin-left: 15px; /* Spacing between buttons */
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            text-transform: uppercase;
            display: flex;
            align-items: center;
            gap: 8px;
            border-radius: 4px;
            pointer-events: auto;
        }
        .mode-switch-btn:hover, .ui-scale-btn:hover {
            background: var(--terminal-green);
            color: black;
            box-shadow: 0 0 15px var(--terminal-green);
            transform: translateY(-2px);
        }

        /* --- UI SCALING OVERRIDES (Large Mode) --- */
        body.ui-large {
            --base-font-size: 18px;
        }

        body.ui-large .login-submit-btn {
            height: 60px;
            padding: 0 40px;
        }
        
        body.ui-large .login-input {
            font-size: 1.4rem;
        }

        body.ui-large .lang-btn {
            padding: 15px 30px;
            font-size: 1.2rem;
        }

        body.ui-large .mode-switch-btn, 
        body.ui-large .ui-scale-btn {
            padding: 12px 24px;
            font-size: 1rem;
        }

        body.ui-large .win-btn {
            width: 40px;
            height: 40px;
            font-size: 20px;
        }
        
        body.ui-large .window-header {
            height: 50px;
        }

        body.ui-large .shop-link-btn,
        body.ui-large .archive-btn,
        body.ui-large .assistant-btn {
            padding: 14px 24px;
            font-size: 1rem;
        }

        body.ui-large .start-btn,
        body.ui-large .task-item {
            height: 50px;
            font-size: 1.1rem;
        }
        
        body.ui-large .taskbar {
            height: 65px;
        }

        body.ui-large .desktop-icon {
            transform: scale(1.1);
            margin-bottom: 20px;
        }

        /* --- MOBILE CONTROLS --- */
        #mobile-controls {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 10000;
            display: none;
            pointer-events: auto;
        }

        .mobile-btn {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid var(--gold-primary);
            color: var(--gold-primary);
            padding: 10px 16px;
            font-family: 'Share Tech Mono';
            font-size: 1rem;
            border-radius: 4px;
            cursor: pointer;
            backdrop-filter: blur(4px);
        }

        /* --- LOGIN SCREEN --- */
        #login-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #000;
            z-index: 5000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.8s ease, transform 0.8s cubic-bezier(0.7, 0, 0.3, 1);
            background: radial-gradient(circle at center, #111 0%, #000 70%);
            pointer-events: auto;
            /* Added padding-bottom to visually shift content upwards */
            padding-bottom: 12vh;
        }
        
        #login-screen.zoom-out {
            opacity: 0;
            transform: scale(2);
            pointer-events: none;
        }

        /* UPDATED: LOGO CONTAINER STYLES */
        .login-header-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 800px;
            margin-bottom: 0; /* Connects closer to box */
            position: relative;
            padding-bottom: 20px; /* Reduced slightly to tighten gap */
            z-index: 10;
            background: linear-gradient(to bottom, transparent, rgba(0,0,0,0.3)); /* Softer gradient */
            animation: fadeIn 2s ease-out;
        }

        /* Natural Gradient Divider */
        .login-header-wrapper::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 5%; /* Indent to make it float */
            width: 90%;
            height: 1px;
            background: linear-gradient(90deg, transparent 0%, var(--gold-dim) 50%, transparent 100%);
            opacity: 0.6;
            box-shadow: 0 1px 5px rgba(212, 175, 55, 0.2);
        }

        .login-logo-img {
            height: auto;
            max-height: 35vh; 
            min-height: 250px;
            width: auto;
            max-width: 95%; 
            filter: drop-shadow(0 0 25px rgba(212, 175, 55, 0.6));
            transition: filter 0.3s, transform 0.3s;
        }
        
        .login-logo-img:hover {
            filter: drop-shadow(0 0 40px rgba(212, 175, 55, 0.9));
            transform: scale(1.02);
        }

        .login-sub-header {
            font-family: 'Share Tech Mono';
            font-size: 0.85rem;
            letter-spacing: 5px; /* Increased for airy feel */
            color: #888; /* Softer text color */
            margin-top: 15px;
            font-weight: normal;
            text-shadow: none;
            opacity: 0.9;
            text-transform: uppercase;
        }

        .login-box {
            /* Removed solid border for a cleaner look */
            border: none;
            padding: 45px 50px;
            text-align: center;
            /* Smoother, deeper shadow */
            box-shadow: 0 40px 100px rgba(0, 0, 0, 0.8); 
            background: linear-gradient(180deg, rgba(10, 10, 10, 0.9) 0%, rgba(5, 5, 5, 0.8) 100%);
            max-width: 550px;
            width: 90%;
            position: relative;
            backdrop-filter: blur(20px);
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 0;
        }

        /* Subtle Side Gradients instead of full border */
        .login-box::before {
            content: '';
            position: absolute;
            top: 0; bottom: 0; left: 0; width: 1px;
            background: linear-gradient(180deg, var(--gold-dim) 0%, transparent 80%);
            opacity: 0.5;
        }
        
        /* Right side gradient */
        .login-box-right-border {
            position: absolute;
            top: 0; bottom: 0; right: 0; width: 1px;
            background: linear-gradient(180deg, var(--gold-dim) 0%, transparent 80%);
            opacity: 0.5;
            pointer-events: none;
        }

        .login-box::after {
            content: "WARNING: UNAUTHORIZED ACCESS IS A FEDERAL OFFENSE";
            position: absolute;
            bottom: -40px;
            font-family: 'Share Tech Mono';
            font-size: 0.65rem;
            color: #555;
            letter-spacing: 2px;
            width: 100%;
            text-align: center;
            text-transform: uppercase;
            opacity: 0.7;
        }

        .login-input-wrapper {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin-top: 20px;
            border-bottom: 2px solid var(--gold-dim);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .login-input-wrapper.focused {
            border-bottom-color: var(--gold-primary);
            box-shadow: 0 10px 30px -10px rgba(212, 175, 55, 0.3);
            transform: scale(1.02);
        }

        .login-input-container {
            display: flex;
            align-items: center;
            background: rgba(0, 0, 0, 0.6);
            padding: 12px 15px;
        }

        .input-prefix {
            color: var(--gold-dim);
            font-family: 'Share Tech Mono';
            margin-right: 10px;
            font-size: 1.1rem;
            animation: blink 1s infinite;
        }

        .login-input {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--gold-primary);
            font-family: 'Share Tech Mono';
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            outline: none;
        }

        .login-input::placeholder {
            color: rgba(212, 175, 55, 0.3);
            letter-spacing: 1px;
        }

        .login-submit-btn {
            background: var(--gold-dim);
            border: 1px solid var(--gold-primary);
            color: black;
            cursor: pointer;
            transition: all 0.2s;
            padding: 0 25px;
            height: 44px;
            margin-left: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.2);
            font-weight: bold;
        }
        .login-submit-btn:hover {
            background: var(--gold-primary);
            color: black;
            transform: scale(1.05);
            box-shadow: 0 0 25px var(--gold-primary);
        }
        .login-submit-btn:active {
            transform: scale(0.95);
        }

        .login-msg {
            height: 20px;
            margin-top: 15px;
            font-family: 'Share Tech Mono';
            font-size: 0.9rem;
            color: var(--terminal-green);
            opacity: 0;
            transition: opacity 0.3s;
        }

        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }

        .lang-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 35px;
            border-bottom: 1px solid var(--gold-dim);
            padding-bottom: 25px;
            width: 100%;
        }

        .lang-btn {
            background: transparent;
            border: 1px solid transparent;
            color: #666;
            padding: 8px 16px;
            font-family: 'Share Tech Mono', monospace;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
            border-radius: 4px;
        }

        .lang-btn.active, .lang-btn:hover {
            border-color: var(--gold-dim);
            color: var(--gold-primary);
            background: rgba(212, 175, 55, 0.1);
            text-shadow: 0 0 5px var(--gold-primary);
        }

        /* --- DESKTOP ENVIRONMENT --- */
        #desktop-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: 
                radial-gradient(circle at 50% 50%, #151515 0%, #000 100%),
                repeating-linear-gradient(0deg, transparent, transparent 1px, rgba(212, 175, 55, 0.03) 1px, rgba(212, 175, 55, 0.03) 2px);
            opacity: 0;
            transition: opacity 1s ease;
            pointer-events: none;
        }

        #desktop-screen.active {
            opacity: 1;
            pointer-events: auto;
        }

        /* Top Bar */
        .os-bar {
            position: absolute;
            top: 0; left: 0; width: 100%;
            height: 70px;
            background: rgba(10, 10, 10, 0.95);
            border-bottom: 1px solid var(--gold-dim);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 25px;
            font-size: 1rem;
            color: #888;
            z-index: 100;
            backdrop-filter: blur(5px);
            pointer-events: auto;
        }

        /* Signal Widget */
        .top-right-group {
            display: flex;
            align-items: center;
            gap: 25px;
            font-size: 1.2rem;
        }

        .signal-widget {
            display: flex;
            align-items: center;
            gap: 12px;
            border-left: 1px solid #333;
            padding-left: 20px;
            padding-right: 10px;
            height: 100%;
            margin-left: auto;
            background: rgba(0, 0, 0, 0.2);
            font-size: 0.85rem;
        }

        .signal-graph { display: flex; align-items: flex-end; gap: 3px; height: 20px; width: 25px; }
        .sig-bar { width: 4px; background: var(--gold-dim); animation: sig-pulse 1s infinite alternate; opacity: 0.5; }
        .sig-bar:nth-child(3) { background: var(--terminal-green); opacity: 0.8; }
        .signal-data { display: flex; flex-direction: column; align-items: flex-end; font-family: 'Share Tech Mono'; line-height: 1; opacity: 0.8; }
        .sig-label { font-size: 0.65rem; color: #555; margin-bottom: 2px; text-transform: uppercase; }
        .sig-value { font-size: 0.85rem; color: var(--terminal-green); }
        .enc-hash { font-family: monospace; font-size: 0.75rem; color: #666; width: 90px; overflow: hidden; white-space: nowrap; text-align: right; }
        @keyframes sig-pulse { 0% { opacity: 0.3; height: 30%; } 100% { opacity: 0.7; height: 100%; } }

        /* Taskbar */
        .taskbar {
            position: absolute;
            bottom: 0; left: 0; width: 100%;
            height: 55px;
            background: rgba(10, 10, 10, 0.95);
            border-top: 1px solid var(--gold-dim);
            display: flex;
            align-items: center;
            padding: 0 10px;
            z-index: 9000;
            backdrop-filter: blur(5px);
            pointer-events: auto;
        }

        .start-btn {
            height: 40px;
            padding: 0 20px;
            background: var(--gold-dim);
            color: black;
            display: flex;
            align-items: center;
            font-weight: bold;
            font-size: 1rem;
            margin-right: 15px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .start-btn:hover { background: var(--gold-primary); box-shadow: 0 0 10px var(--gold-dim); }

        .task-item {
            height: 40px;
            padding: 0 20px;
            margin-right: 8px;
            border: 1px solid #333;
            color: #888;
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 0.95rem;
            min-width: 120px;
            background: #111;
            transition: all 0.2s;
        }
        .task-item:hover { background: #222; color: #ccc; border-color: #555; }
        .task-item.active {
            border-color: var(--gold-dim);
            color: var(--gold-primary);
            background: #1a1a1a;
            box-shadow: inset 0 -2px 0 var(--gold-primary);
        }

        /* Desktop Icons */
        .desktop-icons-container {
            position: absolute;
            top: 90px;
            left: 40px;
            bottom: 80px; 
            display: flex;
            flex-direction: column; 
            flex-wrap: wrap; 
            gap: 20px; 
            z-index: 50;
            align-content: flex-start;
            pointer-events: none;
        }

        .desktop-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 140px;
            margin-right: 20px;
            cursor: pointer;
            text-align: center;
            color: var(--gold-primary);
            opacity: 0.8;
            transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.2s, text-shadow 0.2s;
            pointer-events: auto;
        }

        .desktop-icon:hover, .desktop-icon:focus {
            opacity: 1;
            text-shadow: 0 0 15px var(--gold-primary);
            transform: scale(1.05) translateY(-5px);
            outline: none;
        }
        
        .icon-img {
            width: 80px;
            height: 80px;
            margin-bottom: 12px;
            border: 1px solid transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0,0,0,0.4);
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .desktop-icon:hover .icon-img {
            border-color: var(--gold-dim);
            background: rgba(212, 175, 55, 0.1);
            box-shadow: 0 0 25px rgba(212, 175, 55, 0.15);
        }

        .icon-label {
            font-size: 0.95rem;
            line-height: 1.2;
            background: rgba(0,0,0,0.7);
            padding: 6px 10px;
            border-radius: 6px;
            border: 1px solid transparent;
        }
        
        .desktop-icon:hover .icon-label {
            border-color: rgba(212, 175, 55, 0.3);
        }

        /* --- OS WINDOWS --- */
        .os-window {
            position: absolute;
            background: var(--window-bg);
            border: 1px solid var(--gold-dim);
            box-shadow: 0 20px 50px rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            resize: both;
            overflow: hidden;
            min-width: 350px;
            min-height: 250px;
            border-radius: 2px;
            opacity: 0;
            transform: scale(0.95) translateY(10px);
            transition: opacity 0.3s ease, transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);
            pointer-events: none;
        }

        .os-window.window-open {
            opacity: 1;
            transform: scale(1) translateY(0);
            pointer-events: auto;
        }

        .os-window.active {
            z-index: 101;
            border-color: var(--gold-primary);
            box-shadow: 0 0 60px rgba(212, 175, 55, 0.1), 0 0 0 1px rgba(212, 175, 55, 0.5);
        }
        
        .os-window.minimized {
            opacity: 0 !important;
            transform: scale(0.8) translateY(100px) !important;
            pointer-events: none;
        }

        .os-window.maximized {
            transition: all 0.4s cubic-bezier(0.19, 1, 0.22, 1);
            border-radius: 0;
        }

        /* Draggable Header */
        .window-header {
            height: 42px;
            background: linear-gradient(180deg, rgba(30, 30, 30, 0.95), rgba(15, 15, 15, 0.98));
            border-bottom: 1px solid var(--gold-dim);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 15px;
            cursor: grab; 
            user-select: none;
            touch-action: none;
        }
        .window-header:active { cursor: grabbing; }

        .win-title {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #ddd;
            text-shadow: 0 0 5px rgba(255,255,255,0.2);
        }

        .win-controls { display: flex; gap: 8px; }

        .win-btn {
            width: 24px; height: 24px;
            border: 1px solid #444;
            background: rgba(0,0,0,0.5);
            color: #888;
            font-size: 14px;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            border-radius: 2px;
        }
        .win-btn:hover { background: var(--gold-primary); color: black; border-color: var(--gold-primary); }
        .win-btn.close:hover { background: var(--glitch-red); border-color: var(--glitch-red); color: white; }

        .window-content {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
            position: relative;
            scrollbar-width: thin;
            scrollbar-color: var(--gold-dim) #111;
        }
        
        .window-content::-webkit-scrollbar { width: 6px; }
        .window-content::-webkit-scrollbar-track { background: #0a0a0a; }
        .window-content::-webkit-scrollbar-thumb { background: var(--gold-dim); border-radius: 3px; }

        /* --- PROJECT BRIEF STYLES --- */
        .brief-layout { display: flex; flex-direction: column; gap: 30px; }
        
        .brief-meta {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px solid rgba(212, 175, 55, 0.3);
            padding-bottom: 15px;
            margin-bottom: 20px;
            font-size: 0.9rem;
            color: var(--terminal-green);
            font-family: 'Share Tech Mono';
        }

        .brief-text-col { flex: 1; }
        .brief-visual-col { flex: 0 0 400px; display: flex; flex-direction: column; }

        .brief-frame {
            border: 1px solid var(--gold-primary);
            padding: 8px;
            background: rgba(0, 0, 0, 0.4);
            position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        .brief-frame::before, .brief-frame::after {
            content: ''; position: absolute; width: 12px; height: 12px;
            border: 2px solid var(--gold-primary);
            transition: all 0.3s;
        }
        .brief-frame::before { top: -1px; left: -1px; border-right: none; border-bottom: none; }
        .brief-frame::after { bottom: -1px; right: -1px; border-left: none; border-top: none; }

        .brief-img {
            width: 100%; height: 300px; object-fit: cover;
            background: #111; display: block;
            filter: grayscale(80%) sepia(10%);
            transition: filter 0.5s ease;
        }
        .brief-frame:hover .brief-img { filter: grayscale(0%); }

        .brief-caption {
            background: var(--gold-dim);
            color: black;
            font-size: 0.8rem;
            padding: 4px 6px;
            text-align: center;
            font-weight: bold;
            margin-top: 6px;
        }

        /* NEW STYLES FOR BRIEF ORGANIZATION */
        .brief-section-title {
            color: var(--gold-dim);
            font-family: 'Share Tech Mono';
            font-size: 1rem;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 2px;
            border-bottom: 1px solid rgba(212, 175, 55, 0.2);
            display: inline-block;
            padding-bottom: 2px;
            margin-top: 20px;
        }
        
        .brief-note {
            font-size: 0.95rem !important;
            color: #888 !important;
            font-style: italic;
            border-left: 2px solid #444;
            padding-left: 15px;
            margin-top: 25px;
        }

        @media(min-width: 768px) { .brief-layout { flex-direction: row; } }

        /* --- ARCHIVE STYLES --- */
        .archive-header {
            display: flex; gap: 30px; margin-bottom: 40px;
            border-bottom: 1px solid var(--gold-dim); padding-bottom: 30px;
        }
        .archive-header-img {
            width: 240px; height: 360px; background: #000;
            border: 1px solid var(--gold-primary); flex-shrink: 0; overflow: hidden;
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
        }
        .archive-header-text { flex: 1; display: flex; flex-direction: column; }
        .archive-header h2 { font-family: 'Cinzel'; font-size: 3.5rem; color: var(--gold-primary); margin-bottom: 15px; letter-spacing: 2px; }
        .archive-header p { font-size: 1.1rem; color: #ccc; line-height: 1.7; }

        /* RATES DASHBOARD */
        .rates-dashboard {
            margin-top: 25px; border: 1px solid rgba(212, 175, 55, 0.2);
            background: rgba(0, 0, 0, 0.4); padding: 25px;
            display: flex; flex-direction: column; gap: 25px;
        }
        .rates-section-title {
            font-family: 'Share Tech Mono'; font-size: 0.95rem; color: var(--gold-dim);
            border-bottom: 1px solid rgba(212, 175, 55, 0.2); padding-bottom: 10px; margin-bottom: 10px;
            text-transform: uppercase; letter-spacing: 1px;
        }
        .pack-config { display: flex; gap: 15px; align-items: center; }
        .config-badge {
            display: inline-flex; align-items: center; gap: 8px; padding: 8px 14px;
            background: rgba(255, 255, 255, 0.05); border: 1px solid #444;
            font-size: 0.9rem; color: #eee; border-radius: 4px;
        }
        .config-badge.holo { border-color: var(--glitch-blue); color: var(--glitch-blue); background: rgba(0, 240, 255, 0.05); }
        .config-badge.norm { border-color: #888; color: #aaa; }
        
        .rates-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .rate-card {
            background: rgba(255, 255, 255, 0.02); padding: 20px;
            border-left: 3px solid #333; transition: background 0.3s;
        }
        .rate-card:hover { background: rgba(255, 255, 255, 0.05); }
        .rate-card.holo { border-left-color: var(--glitch-blue); }
        .rate-card.norm { border-left-color: #888; }
        
        .rate-value { font-size: 1.8rem; font-weight: bold; color: #fff; font-family: 'Cinzel'; display: block; }
        .rate-sub { font-size: 0.85rem; color: #666; font-family: 'Share Tech Mono'; display: block; margin-top: 5px; }
        .rate-label { font-size: 0.8rem; color: var(--gold-dim); margin-bottom: 5px; text-transform: uppercase; display: block; }

        .archive-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 25px; }
        .card-file {
            position: relative; border: 1px solid #333; background: rgba(255,255,255,0.02);
            height: 350px; cursor: pointer; transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            overflow: hidden;
        }
        .card-file:hover, .card-file:focus {
            border-color: var(--gold-primary); background: rgba(212, 175, 55, 0.05);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); transform: translateY(-5px);
            outline: none; z-index: 2;
        }
        .card-file img { width: 100%; height: 100%; object-fit: cover; filter: grayscale(100%); opacity: 0.7; transition: all 0.5s ease; }
        .img-loading { opacity: 0 !important; filter: blur(10px) grayscale(100%); transform: scale(1.1); }
        .img-loaded { opacity: 0.7 !important; filter: blur(0) grayscale(100%); transform: scale(1); }
        .card-file:hover img.img-loaded { filter: grayscale(0%); opacity: 1 !important; transform: scale(1.05); }
        .file-label {
            position: absolute; bottom: 0; width: 100%; background: rgba(0,0,0,0.85);
            color: #fff; font-size: 0.95rem; padding: 10px; text-align: center;
            border-top: 1px solid #333; backdrop-filter: blur(2px); transition: all 0.3s;
        }
        .card-file:hover .file-label { border-color: var(--gold-primary); color: var(--gold-primary); background: rgba(0,0,0,0.95); }

        /* --- SHOP / EVENT STYLES --- */
        .shop-item {
            border: 1px solid var(--gold-dim); padding: 30px; margin-bottom: 30px;
            background: rgba(0,0,0,0.5); transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1), box-shadow 0.3s;
        }
        .shop-item:hover {
            transform: translateX(5px); background: rgba(212,175,55,0.03);
            border-color: var(--gold-primary); box-shadow: -5px 5px 20px rgba(0,0,0,0.5);
        }
        .shop-link-btn {
            display: inline-block; margin-top: 15px; font-size: 0.9rem;
            color: var(--terminal-green); border: 1px solid var(--terminal-green);
            padding: 8px 16px; text-decoration: none; background: rgba(0,0,0,0.3);
            transition: all 0.2s; font-family: 'Share Tech Mono';
        }
        .shop-link-btn:hover { background: var(--terminal-green); color: black; box-shadow: 0 0 15px var(--terminal-green); }

        /* --- ARCHIVE CONTROLS --- */
        .archive-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .archive-btn {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid var(--gold-dim);
            color: var(--gold-dim);
            padding: 8px 16px;
            font-family: 'Share Tech Mono';
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
        }

        .archive-btn:hover, .archive-btn.active {
            background: var(--gold-dim);
            color: black;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.2);
        }

        /* --- EMPLOYEE LIST --- */
        .employee-table { width: 100%; border-collapse: collapse; font-size: 1rem; color: #ccc; }
        .employee-table th {
            text-align: left; border-bottom: 1px solid var(--gold-primary); padding: 15px;
            color: var(--gold-primary); font-family: 'Cinzel'; font-size: 1.1rem;
            position: sticky; top: 0; background: #0f0f0f; z-index: 10; box-shadow: 0 5px 10px rgba(0,0,0,0.5);
        }
        .employee-table td { padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .employee-table tbody tr { transition: background 0.2s; }
        .employee-table tbody tr:hover { background: rgba(212, 175, 55, 0.1); }
        
        .role-badge {
            display: inline-block; padding: 5px 10px; border-radius: 4px;
            background: rgba(0, 240, 255, 0.1); border: 1px solid rgba(0, 240, 255, 0.3);
            color: var(--glitch-blue); font-size: 0.85rem; font-family: 'Share Tech Mono'; text-transform: uppercase;
        }

        /* --- ASSISTANT CHARACTER STYLES --- */
        #assistant-overlay {
            position: fixed;
            /* Initial position - JS will override on drag */
            bottom: 80px; 
            right: 40px; 
            width: 360px; 
            z-index: 8000;
            display: none; 
            flex-direction: column;
            align-items: flex-end;
            pointer-events: none; 
        }

        #assistant-overlay.active { display: flex; }

        .assistant-avatar {
            width: 100px; /* Reduced from 150px */
            height: 100px; /* Reduced from 150px */
            border: 3px solid var(--gold-primary); 
            background: #000;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.4);
            margin-bottom: 15px;
            /* Removed fixed float animation to prevent conflict with drag, added hover float */
            transition: transform 0.1s;
            pointer-events: auto;
            position: relative;
            overflow: hidden;
            cursor: grab;
            touch-action: none; /* PREVENTS SCROLLING WHEN DRAGGING */
        }
        
        .assistant-avatar:active { cursor: grabbing; }
        .assistant-avatar:hover { transform: scale(1.05); }

        .assistant-avatar::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at 30% 30%, rgba(212, 175, 55, 0.4), transparent);
        }

        .assistant-avatar svg {
            width: 50px; height: 50px; /* Reduced from 80px */
            transition: transform 0.2s;
        }
        
        .assistant-avatar.talking svg {
            animation: talk-pulse 0.5s infinite alternate;
        }

        .assistant-bubble {
            background: rgba(15, 15, 15, 0.98);
            border: 1px solid var(--gold-primary);
            padding: 25px; 
            border-radius: 12px 12px 0 12px;
            color: var(--gold-primary);
            font-size: 1.1rem; 
            line-height: 1.6;
            margin-bottom: 15px;
            position: relative;
            pointer-events: auto;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-origin: bottom right;
            min-width: 280px;
        }

        .assistant-close-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: transparent;
            border: none;
            color: var(--gold-dim);
            cursor: pointer;
            padding: 4px;
            transition: color 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .assistant-close-btn:hover {
            color: var(--glitch-red);
        }

        .assistant-controls {
            margin-top: 15px; 
            display: flex;
            justify-content: space-between;
            gap: 15px;
        }

        .assistant-btn {
            border: 1px solid var(--gold-dim); background: transparent; color: #888;
            font-size: 0.85rem; padding: 6px 14px; cursor: pointer; font-family: 'Share Tech Mono';
            transition: all 0.2s;
        }
        .assistant-btn:hover { background: var(--gold-dim); color: #000; }

        /* Animations */
        @keyframes flicker { 0% { opacity: 0.6; } 50% { opacity: 0.65; } 100% { opacity: 0.6; } }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        @keyframes talk-pulse { 0% { transform: scale(1); } 100% { transform: scale(1.1) rotate(5deg); } }

        /* --- VIEWER 3D --- */
        #win-viewer {
            background: rgba(5, 5, 5, 0.98) !important;
            backdrop-filter: blur(25px);
            box-shadow: 0 0 100px rgba(0,0,0,0.9);
        }
        .viewer-stage {
            flex: 1; background: #000; border: 1px solid #333; position: relative;
            overflow: hidden; perspective: 1200px; cursor: grab; display: flex; align-items: center; justify-content: center;
            background: radial-gradient(circle at center, #1a1a1a 0%, #000 100%);
            touch-action: none; /* PREVENTS SCROLLING WHEN ROTATING */
        }
        .viewer-stage:active { cursor: grabbing; }
        .viewer-card-wrapper {
            transform-style: preserve-3d; transition: transform 0.1s ease-out;
            height: 80%; width: auto; display: flex; align-items: center; justify-content: center; pointer-events: none;
        }
        #viewer-img {
            max-height: 100%; max-width: 100%; object-fit: contain;
            border: 1px solid #333; box-shadow: 0 20px 50px rgba(0,0,0,0.7); backface-visibility: hidden;
        }
        .viewer-controls-overlay {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            display: flex; align-items: center; gap: 20px; z-index: 10;
            background: rgba(10, 10, 10, 0.85); padding: 12px 25px; border: 1px solid var(--gold-dim);
            border-radius: 30px; backdrop-filter: blur(4px); box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }
        .v-btn {
            background: transparent; border: 1px solid #444; color: var(--gold-primary);
            width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: all 0.2s;
        }
        .v-btn:hover { background: var(--gold-dim); color: #000; border-color: var(--gold-primary); transform: scale(1.1); }
        .viewer-social-btn {
            display: inline-flex; align-items: center; gap: 10px; padding: 12px 24px;
            border: 1px solid var(--gold-dim); color: var(--gold-primary); text-decoration: none;
            background: rgba(0,0,0,0.5); transition: all 0.3s; font-family: 'Share Tech Mono'; text-transform: uppercase;
        }
        .viewer-social-btn:hover {
            background: var(--gold-primary); color: #000; box-shadow: 0 0 20px var(--gold-dim);
        }

        /* --- MOBILE OVERRIDES --- */
        body.is-mobile #mobile-controls { display: block; }
        body.is-mobile .desktop-icons-container {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; top: 90px; left: 0; width: 100%; padding: 0 20px; bottom: auto;
        }
        body.is-mobile .desktop-icon { width: 100%; margin: 0; }
        
        /* Mobile Windows: Full Screen but Allow Drag Override */
        body.is-mobile .os-window {
            width: 95% !important; /* Slightly reduced to allow grabbing edges if needed */
            height: calc(100% - 70px) !important;
            /* Removed !important from top/left to allow JS dragging */
            top: 60px; 
            left: 2.5%;
            border: none;
            border-bottom: 1px solid var(--gold-dim);
            z-index: 9999; 
            box-shadow: none;
            border-radius: 0;
        }

        body.is-mobile .os-window.active {
            display: flex !important;
        }

        body.is-mobile .window-header {
            height: 60px; /* Increased for touch */
            background: #111;
            padding: 0 15px;
        }

        body.is-mobile .win-btn {
            width: 48px; /* Min 44px touch target */
            height: 48px;
            font-size: 24px;
            margin-left: 10px;
            background: transparent;
            border: 1px solid #444;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Hide maximize/minimize on mobile, keep close */
        body.is-mobile .win-btn:first-child { display: none; }

        body.is-mobile .taskbar {
            z-index: 10000; 
            height: 60px; /* Increased */
            justify-content: flex-start; /* Align left to accommodate home button */
            padding-left: 15px;
        }

        body.is-mobile .start-btn {
            display: none; 
        }

        /* Show mobile nav buttons */
        body.is-mobile .mobile-home-btn {
            display: flex;
            width: 48px; height: 48px; /* 44px+ */
        }
        
        body.is-mobile .mobile-back-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gold-primary);
            width: 48px; height: 48px; /* 44px+ */
            padding: 0;
        }
        
        body.is-mobile #task-list {
            flex: 1;
            overflow-x: auto;
            justify-content: flex-start;
        }
        
        body.is-mobile .task-item {
             flex: 0 0 auto;
             min-width: 100px;
             height: 48px; /* Taller touch target */
             justify-content: center;
             font-size: 1rem;
        }

        body.is-mobile #assistant-overlay {
            right: 50%;
            transform: translateX(50%);
            bottom: 70px;
            width: 90%;
            align-items: center;
        }
        
        body.is-mobile .login-box {
            width: 95%;
            padding: 30px;
        }

        body.is-mobile .employee-table { display: block; }
        body.is-mobile .employee-table thead { display: none; }
        body.is-mobile .employee-table tr {
            display: block; background: rgba(255, 255, 255, 0.03); border: 1px solid var(--gold-dim);
            margin-bottom: 20px; padding: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        body.is-mobile .employee-table td {
            display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px dashed rgba(255, 255, 255, 0.1); text-align: right;
        }
        body.is-mobile .employee-table td::before {
            content: attr(data-label); font-family: 'Share Tech Mono'; color: var(--gold-dim);
            font-weight: bold; font-size: 0.85rem; margin-right: 15px;
        }
        body.is-mobile .archive-header { flex-direction: column; align-items: center; text-align: center; }
        body.is-mobile .selector-grid { grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)) !important; }
        body.is-mobile .variant-img-box { height: 140px !important; }
        
        /* Event Countdown */
        .event-countdown {
            font-family: 'Share Tech Mono', monospace; font-size: 0.95rem; color: var(--glitch-blue);
            margin-top: 10px; padding: 8px 14px; background: rgba(0, 240, 255, 0.05);
            border: 1px solid rgba(0, 240, 255, 0.2); display: inline-block; letter-spacing: 1px;
        }

        /* --- VARIANT SELECTOR STYLES (Fix for Desktop) --- */
        .selector-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 25px;
            padding-bottom: 20px;
        }

        .variant-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--gold-dim);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        .variant-card:hover, .variant-card:focus {
            border-color: var(--gold-primary);
            background: rgba(212, 175, 55, 0.1);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            outline: none;
        }

        .variant-img-box {
            width: 100%;
            height: 280px;
            background: #000;
            overflow: hidden;
            border-bottom: 1px solid var(--gold-dim);
            position: relative;
        }

        .variant-img-box img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
            filter: grayscale(80%);
        }

        .variant-card:hover .variant-img-box img {
            transform: scale(1.05);
            filter: grayscale(0%);
        }

        .variant-info {
            padding: 15px;
            text-align: center;
            background: rgba(0,0,0,0.6);
        }

        .variant-char {
            color: #fff;
            font-family: 'Cinzel';
            font-size: 1.1rem;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .variant-artist {
            color: var(--gold-dim);
            font-size: 0.85rem;
            font-family: 'Share Tech Mono';
            text-transform: uppercase;
        }

        /* --- NEW: RIPPLE EFFECT --- */
        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3); /* White ripple for visibility on dark/gold */
            transform: scale(0);
            animation: ripple-anim 0.6s linear;
            pointer-events: none;
            z-index: 1000;
        }

        @keyframes ripple-anim {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

        /* Ensure containers clip the ripple */
        button, .desktop-icon, .shop-link-btn, .win-btn, .lang-btn, .login-submit-btn, .mobile-btn, .assistant-btn, .archive-btn, .v-btn, .gallery-nav, .variant-card, .task-item {
            position: relative;
            overflow: hidden;
        }

        /* --- NEW: AUTO-LOGIN PROGRESS --- */
        .login-progress-container {
            width: 100%;
            max-width: 400px; /* Match input width */
            height: 2px;
            background: rgba(255, 255, 255, 0.05);
            margin-top: 15px;
            position: relative;
            overflow: hidden;
            border-radius: 2px;
        }

        .login-progress-bar {
            width: 0%;
            height: 100%;
            background: var(--gold-primary);
            box-shadow: 0 0 10px var(--gold-primary);
            /* Transition set via JS for control */
        }
    </style>
</head>
<body id="main-body">

    <div class="crt-overlay"></div>
    <div class="vignette"></div>

    <!-- Mobile Rotate Button -->
    <div id="mobile-controls">
        <button class="mobile-btn" onclick="System.toggleRotation()" aria-label="Rotate Screen">
            <i data-lucide="rotate-cw"></i> <span data-i18n="btn_rotate">ROTATE</span>
        </button>
    </div>

    <!-- WRAPPER FOR ROTATION -->
    <div id="app-container">

        <!-- LOGIN SCREEN -->
        <div id="login-screen">
            <!-- Mode Switcher on Login -->
            <div style="position: absolute; top: 20px; right: 20px; display: flex;">
                <button class="ui-scale-btn" onclick="System.toggleUIScale()" aria-label="Toggle Interface Size">
                    <!-- Content populated by JS -->
                    [SIZE: NORMAL]
                </button>
                <button class="mode-switch-btn" onclick="System.toggleMode()" aria-label="Toggle View Mode">
                    <!-- Content populated by JS -->
                    [UI_MODE_LOADING]
                </button>
            </div>

            <!-- Title Moved Outside Box -->
            <div class="login-header-wrapper">
                <img src="https://media.discordapp.net/attachments/1457280504758800384/1457648148326649964/Distortion_Corp_taxx.png?ex=695cc420&is=695b72a0&hm=33a41f81f9073d9a1b1b17d6b19e9a4b7e12f165fa303512597e12a027c3c191&=&format=webp&quality=lossless&width=1466&height=1869" 
                     alt="DISTORTION CORP LOGO" 
                     class="login-logo-img">
                <div class="login-sub-header">SECURE TERMINAL ACCESS // LEVEL 5 CLEARANCE</div>
            </div>

            <div class="login-box">
                <div class="login-box-right-border"></div> <!-- Added for symmetry -->
                
                <div class="lang-selector">
                    <button class="lang-btn active" onmouseenter="AudioManager.play('hover')" onclick="System.setLanguage('en'); AudioManager.play('click')" aria-label="Select English">EN</button>
                    <button class="lang-btn" onmouseenter="AudioManager.play('hover')" onclick="System.setLanguage('ko'); AudioManager.play('click')" aria-label="Select Korean"></button>
                    <button class="lang-btn" onmouseenter="AudioManager.play('hover')" onclick="System.setLanguage('ja'); AudioManager.play('click')" aria-label="Select Japanese"></button>
                </div>

                <p data-i18n="login_sub" style="font-size: 1rem; color: #888; margin-bottom: 10px; font-family: 'Share Tech Mono'; letter-spacing: 2px;">SECURE ACCESS TERMINAL v9.4</p>
                
                <!-- NEW: OPTIMIZATION NOTICE -->
                <p data-i18n="login_opt" style="font-size: 0.8rem; color: #555; margin-bottom: 25px; font-family: 'Share Tech Mono'; letter-spacing: 1px;">>> TERMINAL OPTIMIZED FOR DESKTOP DISPLAY</p>
                
                <!-- LOGIN INPUT BAR -->
                <div class="login-input-wrapper" id="login-wrapper">
                    <div class="login-input-container">
                        <span class="input-prefix">></span>
                        <input type="text" id="login-input" class="login-input" placeholder="ENTER_ACCESS_CODE..." autocomplete="off" spellcheck="false" aria-label="Access Code Input">
                        <button class="login-submit-btn" onclick="System.login()" title="ENTER SYSTEM" aria-label="Enter System">
                            <i data-lucide="arrow-right" width="28" height="28"></i> <!-- Larger Icon -->
                        </button>
                    </div>
                </div>

                <div id="login-message" class="login-msg" data-i18n="login_verifying">VERIFYING CREDENTIALS...</div>
                
                <!-- NEW: AUTO LOGIN PROGRESS -->
                <div class="login-progress-container" aria-hidden="true">
                    <div id="auto-login-bar" class="login-progress-bar"></div>
                </div>
            </div>
        </div>

        <!-- DESKTOP SCREEN -->
        <div id="desktop-screen">
            
            <!-- OS Top Bar -->
            <div class="os-bar">
                <div style="display: flex; align-items: center;">
                    <div data-i18n="os_connected" style="margin-right: 20px;">DISTORTION_OS // CONNECTED</div>
                    <button class="ui-scale-btn" onclick="System.toggleUIScale()" aria-label="Toggle Interface Size">
                        [SIZE]
                    </button>
                    <button class="mode-switch-btn" onclick="System.toggleMode()" aria-label="Toggle View Mode">
                        [UI_MODE]
                    </button>
                </div>
                
                <div class="top-right-group">
                    <div id="clock" aria-label="System Clock">00:00:00</div>
                </div>
            </div>

            <!-- Desktop Icons -->
            <div class="desktop-icons-container">
                <div class="desktop-icon" data-window="win-overview" tabindex="0" role="button" aria-label="Project Brief">
                    <div class="icon-img"><i data-lucide="file-text" width="64" height="64"></i></div>
                    <div data-i18n="icon_overview" class="icon-label">PROJECT_BRIEF.LOG</div>
                </div>

                <div class="desktop-icon" data-window="win-archive" tabindex="0" role="button" aria-label="Archive Database">
                    <div class="icon-img"><i data-lucide="database" width="64" height="64"></i></div>
                    <div data-i18n="icon_archive" class="icon-label">FIRST LIGHT: ARCHIVE_DB.EXE</div>
                </div>
                
                <div class="desktop-icon" data-window="win-employees" tabindex="0" role="button" aria-label="Employee Database">
                    <div class="icon-img"><i data-lucide="users" width="64" height="64"></i></div>
                    <div data-i18n="icon_employees" class="icon-label">EMPLOYEE_DB.EXE</div>
                </div>

                <div class="desktop-icon" data-window="win-shop" tabindex="0" role="button" aria-label="Event Log">
                    <div class="icon-img"><i data-lucide="calendar" width="64" height="64"></i></div>
                    <div data-i18n="icon_shop" class="icon-label">EVENT_LOG.TXT</div>
                </div>

                <div class="desktop-icon" data-window="win-comm" tabindex="0" role="button" aria-label="Communication">
                    <div class="icon-img"><i data-lucide="radio" width="64" height="64"></i></div>
                    <div data-i18n="icon_comm" class="icon-label">COMMUNICATION.EXE</div>
                </div>

                <div class="desktop-icon" data-window="win-settings" tabindex="0" role="button" aria-label="System Settings">
                    <div class="icon-img"><i data-lucide="settings" width="64" height="64"></i></div>
                    <div data-i18n="icon_settings" class="icon-label">SYSTEM_SETTINGS.EXE</div>
                </div>

                <div class="desktop-icon" data-window="win-tos" tabindex="0" role="button" aria-label="Terms of Service">
                    <div class="icon-img"><i data-lucide="file-check" width="64" height="64"></i></div>
                    <div data-i18n="icon_tos" class="icon-label">TERMS_OF_SERVICE.TXT</div>
                </div>

                <!-- NEW: ASSISTANT WIDGET -->
                <div class="desktop-icon" onclick="System.openAssistant(); AudioManager.play('click')" tabindex="0" role="button" aria-label="Open AI Assistant">
                    <div class="icon-img"><i data-lucide="bot" width="64" height="64"></i></div>
                    <div data-i18n="icon_assistant" class="icon-label">ASSISTANT_AI.EXE</div>
                </div>
            </div>

            <!-- WINDOW: OVERVIEW -->
            <div id="win-overview" class="os-window" style="top: 10%; left: 15%; width: 950px; height: 650px;">
                <div class="window-header">
                    <div style="display: flex; align-items: center;">
                        <div class="mobile-back-btn" onclick="WindowManager.close('win-overview')" aria-label="Back"><i data-lucide="arrow-left" width="36" height="36"></i></div>
                        <span data-i18n="win_overview" class="win-title">PROJECT_BRIEF.LOG</span>
                    </div>
                    <div class="win-controls">
                        <div class="win-btn" aria-label="Minimize Window" onclick="WindowManager.minimize('win-overview')"><i data-lucide="minus" width="14"></i></div>
                        <div class="win-btn" aria-label="Maximize Window" onclick="WindowManager.toggleMaximize('win-overview')"><i data-lucide="maximize" width="14"></i></div>
                        <div class="win-btn close" aria-label="Close Window" onclick="WindowManager.close('win-overview')"><i data-lucide="x" width="14"></i></div>
                    </div>
                </div>
                <div class="window-content">
                    
                    <div class="brief-meta">
                        <span data-i18n="brief_id">ID: 001-GENESIS-DIVINA</span>
                        <span data-i18n="brief_clearance">CLEARANCE: PUBLIC</span>
                    </div>

                    <div class="brief-layout">
                        <!-- Left Column: Text -->
                        <div class="brief-text-col">
                            <h1 data-i18n="overview_title" style="font-family: 'Cinzel'; font-size: 2.5rem; margin-bottom: 25px; color: var(--gold-primary); text-shadow: 0 0 10px rgba(212,175,55,0.2);">DISTORTION DIVINA</h1>
                            
                            <!-- GOAL SECTION -->
                            <div class="brief-section-title" data-i18n="overview_label_goal">GOAL</div>
                            <p data-i18n="overview_text_1" style="margin-bottom: 10px; line-height: 1.6; color: #ccc; font-size: 1.1rem;">
                                Distortion Divina is an unofficial fan project inspired by the worlds of Project Moon and Project Mili. Our dream is to build a collectible, tarot-inspired card game- created by fans, for fans.
                            </p>

                            <!-- PLAN SECTION -->
                            <div class="brief-section-title" data-i18n="overview_label_plan">PLAN</div>
                            <p data-i18n="overview_text_plan" style="line-height: 1.6; color: #aaa; font-size: 1.1rem;">
                                We are building this vision in phases. Our first chapter, First Light, is dedicated to proving our creative process. Our priority right now is simply to deliver stunning, high-quality illustrations that pay proper homage to the source material.
                            </p>

                            <!-- ACQUISITION SECTION -->
                            <div class="brief-section-title" data-i18n="overview_label_acquisition">ACQUISITION</div>
                            <p data-i18n="overview_text_acquisition" style="margin-bottom: 15px; line-height: 1.6; color: #ccc; font-size: 1.1rem;">
                                First Light packs will be available exclusively at upcoming offline events. Check our schedule for locations.
                            </p>
                            <button class="shop-link-btn" onclick="WindowManager.close('win-overview'); WindowManager.open('win-shop'); AudioManager.play('click');" data-i18n="btn_check_events" aria-label="View Event Schedule">
                                [ VIEW EVENT SCHEDULE ]
                            </button>

                            <!-- NOTE SECTION (Smaller) -->
                            <p data-i18n="overview_text_note" class="brief-note">
                                This is a passion project currently running on personal funds. Every penny of profit goes directly to our amazing artists and brings us one step closer to the full game. We hope you'll join us on this journey.
                            </p>
                        </div>

                        <!-- Right Column: Image Area -->
                        <div class="brief-visual-col">
                            <div class="brief-frame">
                                <div style="position: relative; width: 100%; height: 300px; background: #000; cursor: pointer;" onclick="System.changeBriefImage(1)" title="Click for Next Image" role="button" aria-label="Click to view next image">
                                    <!-- Updated Initial Image Source (New First Image) -->
                                    <img id="brief-img-display" src="https://media.discordapp.net/attachments/1457280504758800384/1457280757872459963/misson.jpg?ex=695c16b7&is=695ac537&hm=d2e73c757c351f8f5311594475811ac5147642e367484fc54ccb8331681b67db&=&format=webp&width=2645&height=1869" class="brief-img" alt="Project Visual" style="height: 100%; object-fit: cover;" onerror="this.style.display='none'">
                                </div>
                                <div id="brief-caption-display" class="brief-caption" data-i18n="brief_fig_main">FIG_0: PROJECT_CONCEPT</div>
                                
                                <!-- Image Counter -->
                                <div id="brief-img-counter" style="text-align: center; font-size: 0.75rem; color: #666; margin-top: 5px; font-family: 'Share Tech Mono';">[ 1 / 5 ]</div>
                            </div>
                            
                            <div style="margin-top: 20px; border: 1px dashed #333; padding: 15px; font-size: 0.85rem; color: #666;">
                                <div style="color: var(--terminal-green); margin-bottom: 8px;" data-i18n="brief_sys_notes_label">> SYSTEM NOTES:</div>
                                <span data-i18n="brief_sys_notes">The "First Light" initiative is currently active. All personnel are advised to review the Archive DB for drop rates.</span>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- WINDOW: ARCHIVE -->
            <div id="win-archive" class="os-window" style="top: 5%; left: 35%; width: 900px; height: 700px;">
                <div class="window-header">
                    <div style="display: flex; align-items: center;">
                        <div class="mobile-back-btn" onclick="WindowManager.close('win-archive')" aria-label="Back"><i data-lucide="arrow-left" width="36" height="36"></i></div>
                        <span data-i18n="win_archive" class="win-title">FIRST LIGHT: ARCHIVE_DB.EXE</span>
                    </div>
                    <div class="win-controls">
                        <div class="win-btn" aria-label="Minimize Window" onclick="WindowManager.minimize('win-archive')"><i data-lucide="minus" width="14"></i></div>
                        <div class="win-btn" aria-label="Maximize Window" onclick="WindowManager.toggleMaximize('win-archive')"><i data-lucide="maximize" width="14"></i></div>
                        <div class="win-btn close" aria-label="Close Window" onclick="WindowManager.close('win-archive')"><i data-lucide="x" width="14"></i></div>
                    </div>
                </div>
                <div class="window-content">
                    <div class="archive-header">
                        <div class="archive-header-img">
                            <img src="https://media.discordapp.net/attachments/1457280504758800384/1457290787942568110/background.png?ex=695b774e&is=695a25ce&hm=3cb1d8a77e954f6f037aa56cbc37d93bfa8f96b09f6ec4ae1d5b1079a837f35a&=&format=webp&quality=lossless&width=621&height=887" style="width: 100%; height: 100%; object-fit: cover;" onerror="this.src='https://placehold.co/200x300/000/333?text=Error'" alt="Archive Header Image">
                        </div>
                        <div class="archive-header-text">
                            <h2 data-i18n="archive_title">FIRST LIGHT</h2>
                            <p data-i18n="archive_desc">The initial manifestation. A collection of archetypes emerging from the distortion. Witness the beginning of the reconstruction.</p>
                            
                            <div class="rates-dashboard">
                                <!-- MOVED & STYLED DISTRIBUTION NOTICE -->
                                <div style="margin-bottom: 25px; padding: 15px; border: 1px solid var(--terminal-green); background: rgba(51, 255, 0, 0.05); font-size: 0.95rem; color: #ddd; line-height: 1.5; box-shadow: 0 0 20px rgba(51, 255, 0, 0.1);">
                                    <div style="color: var(--terminal-green); font-weight: bold; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; font-family: 'Share Tech Mono'; letter-spacing: 1px;">
                                        <i data-lucide="alert-triangle" width="16"></i>
                                        <span data-i18n="archive_dist_proto_label">>> DISTRIBUTION PROTOCOL:</span>
                                    </div>
                                    <span data-i18n="archive_dist_proto">First Light is distributed in sealed packs of 5 cards (4 Normal, 1 Holographic). Contents are randomized by the system; individual selection is not permitted. May the luck of the draw be with you.</span>
                                </div>

                                <!-- NEW: LINK TO EVENT LOG -->
                                <button class="shop-link-btn" style="width: 100%; margin-top: 0; margin-bottom: 25px; text-align: center; justify-content: center; display: flex; gap: 10px;" onclick="WindowManager.close('win-archive'); WindowManager.open('win-shop'); AudioManager.play('click');" aria-label="Where to Acquire">
                                    <i data-lucide="map-pin" width="16"></i> <span data-i18n="btn_where_to_buy">[ WHERE TO ACQUIRE ]</span>
                                </button>

                                <div class="rates-section">
                                    <div class="rates-section-title" data-i18n="rates_title">PACK CONFIGURATION</div>
                                    <div class="pack-config">
                                        <div class="config-badge holo">
                                            <i data-lucide="sparkles" width="18"></i> <span data-i18n="rates_content_holo">1x HOLOGRAPHIC</span>
                                        </div>
                                        <div class="config-badge norm">
                                            <i data-lucide="layers" width="18"></i> <span data-i18n="rates_content_norm">4x NORMAL</span>
                                        </div>
                                    </div>
                                    <div style="font-size: 0.9rem; color: #666; margin-top: 8px;" data-i18n="rates_total_count">Total: 9 Holo / 29 Normal</div>
                                </div>

                                <div class="rates-section">
                                    <div class="rates-section-title" data-i18n="rates_drop_title">DROP RATES (PER SLOT)</div>
                                    <div class="rates-grid">
                                        <div class="rate-card holo">
                                            <span class="rate-label" data-i18n="rates_holo_label">SPECIFIC HOLO</span>
                                            <span class="rate-value">11.1%</span>
                                            <span class="rate-sub">1 / 9</span>
                                        </div>
                                        <div class="rate-card norm">
                                            <span class="rate-label" data-i18n="rates_norm_label">SPECIFIC NORMAL</span>
                                            <span class="rate-value">3.57%</span>
                                            <span class="rate-sub">1 / 29</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; padding-bottom: 15px; margin-bottom: 20px;">
                        <div style="font-size: 1rem; color: #666;"><span data-i18n="archive_status">> LOADING ASSETS... COMPLETE</span></div>
                        
                        <!-- NEW SORT CONTROLS -->
                        <div class="archive-controls" style="margin-bottom: 0;">
                            <button class="archive-btn active" onclick="System.renderGrid('id', this)" data-i18n="btn_sort_tarot" aria-label="Sort by Tarot Number">[ SORT: TAROT ]</button>
                            <button class="archive-btn" onclick="System.renderGrid('name', this)" data-i18n="btn_sort_name" aria-label="Sort Alphabetically">[ SORT: A-Z ]</button>
                            <button class="archive-btn" onclick="System.renderGrid('id', this)" data-i18n="btn_view_all" aria-label="View All Cards">[ VIEW: ALL ]</button>
                        </div>
                    </div>

                    <div class="archive-grid" id="cardGrid"></div>
                </div>
            </div>
            
            <!-- WINDOW: VARIANT SELECTOR -->
            <div id="win-selector" class="os-window" style="display: none; top: 10%; left: 15%; width: 1000px; height: 800px; z-index: 2001;">
                <div class="window-header" style="background: linear-gradient(90deg, #1a1a1a, #000); border-bottom: 1px solid var(--gold-primary);">
                    <div style="display: flex; align-items: center;">
                        <div class="mobile-back-btn" onclick="WindowManager.close('win-selector')" aria-label="Back"><i data-lucide="arrow-left" width="36" height="36"></i></div>
                        <span class="win-title" style="color: var(--gold-primary);">VARIANT_SELECTOR.EXE</span>
                    </div>
                    <div class="win-controls">
                        <div class="win-btn" onclick="WindowManager.toggleMaximize('win-selector')" aria-label="Maximize Window"><i data-lucide="maximize" width="14"></i></div>
                        <div class="win-btn close" aria-label="Close Window" onclick="WindowManager.close('win-selector')"><i data-lucide="x" width="14"></i></div>
                    </div>
                </div>
                <div class="window-content">
                    <h2 id="selector-title" style="font-family: 'Cinzel'; color: white; margin-bottom: 10px; font-size: 2rem;">SELECT VARIANT</h2>
                    <p data-i18n="selector_sub" style="color: #888; font-size: 1rem; margin-bottom: 25px;">Multiple data streams detected. Select a timeline to view.</p>
                    <div id="selector-grid" class="selector-grid"></div>
                </div>
                <!-- Styles for Selector Grid ... existing ... -->
            </div>
            
            <!-- WINDOW: EMPLOYEES -->
            <div id="win-employees" class="os-window" style="top: 8%; left: 15%; width: 850px; height: 600px;">
                <div class="window-header">
                    <div style="display: flex; align-items: center;">
                        <div class="mobile-back-btn" onclick="WindowManager.close('win-employees')" aria-label="Back"><i data-lucide="arrow-left" width="36" height="36"></i></div>
                        <span data-i18n="win_employees" class="win-title">EMPLOYEE_DB.EXE</span>
                    </div>
                    <div class="win-controls">
                        <div class="win-btn" aria-label="Minimize Window" onclick="WindowManager.minimize('win-employees')"><i data-lucide="minus" width="14"></i></div>
                        <div class="win-btn" aria-label="Maximize Window" onclick="WindowManager.toggleMaximize('win-employees')"><i data-lucide="maximize" width="14"></i></div>
                        <div class="win-btn close" aria-label="Close Window" onclick="WindowManager.close('win-employees')"><i data-lucide="x" width="14"></i></div>
                    </div>
                </div>
                <div class="window-content">
                    <div style="margin-bottom: 25px; border-bottom: 1px solid var(--gold-dim); padding-bottom: 15px;">
                        <h2 data-i18n="employees_header" style="font-family: 'Cinzel'; margin-bottom: 10px; font-size: 2rem;">PERSONNEL DATABASE</h2>
                        <div style="font-size: 1rem; color: var(--terminal-green);"><span data-i18n="emp_accessing">> ACCESSING TEAM RECORDS...</span></div>
                    </div>
                    
                    <div style="overflow-x: auto;">
                        <table class="employee-table">
                            <thead>
                                <tr>
                                    <th data-i18n="th_no">NO.</th>
                                    <th data-i18n="th_card">CARD</th>
                                    <th data-i18n="th_char">CHARACTER</th>
                                    <th data-i18n="th_emp">EMPLOYEES</th>
                                    <th data-i18n="th_pen">PEN NAME</th>
                                    <th data-i18n="th_role">ROLE</th>
                                </tr>
                            </thead>
                            <tbody id="employee-list-body">
                                <!-- JS Populated -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- WINDOW: SHOP / EVENTS -->
            <div id="win-shop" class="os-window" style="top: 15%; left: 25%; width: 700px; height: 600px;">
                <div class="window-header">
                    <div style="display: flex; align-items: center;">
                        <div class="mobile-back-btn" onclick="WindowManager.close('win-shop')" aria-label="Back"><i data-lucide="arrow-left" width="36" height="36"></i></div>
                        <span data-i18n="icon_shop" class="win-title">EVENT_LOG.TXT</span>
                    </div>
                    <div class="win-controls">
                        <div class="win-btn" aria-label="Minimize Window" onclick="WindowManager.minimize('win-shop')"><i data-lucide="minus" width="14"></i></div>
                        <div class="win-btn" aria-label="Maximize Window" onclick="WindowManager.toggleMaximize('win-shop')"><i data-lucide="maximize" width="14"></i></div>
                        <div class="win-btn close" aria-label="Close Window" onclick="WindowManager.close('win-shop')"><i data-lucide="x" width="14"></i></div>
                    </div>
                </div>
                <div class="window-content">
                    <h2 data-i18n="shop_header" style="font-family: 'Cinzel'; margin-bottom: 25px; font-size: 2rem;">UPCOMING EVENTS</h2>
                    
                    <!-- Event 1: Lunatic Moonlight -->
                    <div class="shop-item" style="display: flex; gap: 25px; align-items: flex-start;">
                        <div style="flex: 1;">
                            <h3 data-i18n="event_1_title" style="color: #fff; font-size: 1.5rem;">LUNATIC MOONLIGHT EVENT</h3>
                            
                            <div style="margin: 15px 0; font-size: 1rem; color: #aaa; border-left: 2px solid var(--gold-dim); padding-left: 15px;">
                                <p data-i18n="event_1_loc" style="margin-bottom: 6px;">LOCATION: TOKYO</p>
                                <p style="color: var(--terminal-green); font-weight: bold; margin-bottom: 6px;" data-i18n="event_1_booth">BOOTH: A14 (DISTORTION CORP)</p>
                                <p style="color: #ccc;" data-i18n="event_1_time">TIME: 11:30 - 16:00</p>
                            </div>

                            <!-- COUNTDOWN 1 -->
                            <div id="countdown-1" class="event-countdown">CALCULATING T-MINUS...</div>

                            <div data-i18n="event_1_date" style="font-size: 1.4rem; color: var(--gold-primary); margin-top: 15px;">15 FEB 2026</div>
                            
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <a href="https://lunaticmoonight.jimdosite.com" target="_blank" class="shop-link-btn" data-i18n="btn_event_site" aria-label="Visit Lunatic Moonlight Website">[ EVENT WEBSITE ]</a>
                                <a href="https://lunaticmoonight.jimdosite.com/%E3%82%B5%E3%83%BC%E3%82%AF%E3%83%AB%E3%83%AA%E3%82%B9%E3%83%88/" target="_blank" class="shop-link-btn" data-i18n="btn_booth_map" aria-label="View Booth Map">[ BOOTH MAP ]</a>
                            </div>
                        </div>
                        
                        <!-- Event Image Section -->
                        <div style="flex: 0 0 140px; border: 1px solid var(--gold-dim); height: 140px; background: #000; overflow: hidden;">
                            <img src="https://media.discordapp.net/attachments/1457280504758800384/1457644392830603413/46788.PNG?ex=695cc0a0&is=695b6f20&hm=b2788f73193b508ea7342dd225cb5c05c603fc6167420a0cc0171c3a3c9b8a65&=&format=webp&quality=lossless&width=1049&height=1127" style="width: 100%; height: 100%; object-fit: cover;" alt="Event Visual">
                        </div>
                    </div>

                    <!-- Event 2: One Million Moon -->
                    <div class="shop-item" style="display: flex; gap: 25px; align-items: flex-start;">
                        <div style="flex: 1;">
                            <h3 data-i18n="event_2_title" style="color: #fff; font-size: 1.5rem;">ONE MILLION MOON CONCERT</h3>
                            <p data-i18n="event_2_loc" style="color: #888; font-size: 1rem; margin: 10px 0;">LOCATION: JAPAN</p>
                            
                            <!-- COUNTDOWN 2 -->
                            <div id="countdown-2" class="event-countdown" style="margin-bottom: 12px;">CALCULATING T-MINUS...</div>

                            <div data-i18n="event_2_date" style="font-size: 1.4rem; color: var(--gold-primary); margin-top: 8px;">21 FEB 2026</div>
                            <a href="https://global.onemillionmoons.kr" target="_blank" class="shop-link-btn" data-i18n="btn_event_site" aria-label="Visit One Million Moon Website">[ EVENT WEBSITE ]</a>
                        </div>

                        <!-- Event Image Section -->
                        <div style="flex: 0 0 140px; border: 1px solid var(--gold-dim); height: 140px; background: #000; overflow: hidden;">
                            <img src="https://media.discordapp.net/attachments/1457280504758800384/1457644745873690675/45674.PNG?ex=695cc0f5&is=695b6f75&hm=915304dc7f43337721d70c0abca3de8c5dba36f95490abfe017ffc91cf49e088&=&format=webp&quality=lossless&width=1881&height=1869" style="width: 100%; height: 100%; object-fit: cover;" alt="Event Visual">
                        </div>
                    </div>

                    <!-- Event 3 -->
                    <div class="shop-item" style="border-color: var(--gold-primary); background: rgba(212,175,55,0.05);">
                        <h3 data-i18n="event_3_title" style="color: #fff; font-size: 1.5rem;">ONLINE STORE OPENING</h3>
                        <p data-i18n="event_3_desc" style="color: var(--terminal-green); font-size: 1.1rem; margin: 15px 0;">STATUS: COMING SOON</p>
                    </div>
                </div>
            </div>

            <!-- WINDOW: COMMUNICATION -->
            <div id="win-comm" class="os-window" style="top: 20%; left: 30%; width: 450px; height: 400px;">
                <div class="window-header">
                    <div style="display: flex; align-items: center;">
                        <div class="mobile-back-btn" onclick="WindowManager.close('win-comm')" aria-label="Back"><i data-lucide="arrow-left" width="36" height="36"></i></div>
                        <span data-i18n="win_comm" class="win-title">COMMUNICATION.EXE</span>
                    </div>
                    <div class="win-controls">
                        <div class="win-btn" aria-label="Minimize Window" onclick="WindowManager.minimize('win-comm')"><i data-lucide="minus" width="14"></i></div>
                        <div class="win-btn" aria-label="Maximize Window" onclick="WindowManager.toggleMaximize('win-comm')"><i data-lucide="maximize" width="14"></i></div>
                        <div class="win-btn close" aria-label="Close Window" onclick="WindowManager.close('win-comm')"><i data-lucide="x" width="14"></i></div>
                    </div>
                </div>
                <div class="window-content">
                    <h2 data-i18n="comm_header" style="font-family: 'Cinzel'; margin-bottom: 25px; font-size: 2rem;">SECURE UPLINKS</h2>
                    
                    <!-- Twitter -->
                    <div class="shop-item">
                        <h3 style="color: #fff; display: flex; align-items: center; gap: 10px;">
                            <i data-lucide="twitter" width="24" height="24"></i> 
                            <span data-i18n="comm_twitter">TWITTER // X</span>
                        </h3>
                        <p data-i18n="comm_sub_twitter" style="color: #888; font-size: 1rem; margin: 8px 0;">> ENCRYPTED FEED ESTABLISHED</p>
                        <a href="https://x.com/DistortDivina" target="_blank" class="shop-link-btn" data-i18n="btn_visit" aria-label="Visit Twitter Page">[ VISIT LINK ]</a>
                    </div>

                    <!-- Discord -->
                    <div class="shop-item">
                        <h3 style="color: #fff; display: flex; align-items: center; gap: 10px;">
                            <i data-lucide="message-circle" width="24" height="24"></i> 
                            <span data-i18n="comm_discord">DISCORD SERVER</span>
                        </h3>
                        <p data-i18n="comm_sub_discord" style="color: #888; font-size: 1rem; margin: 8px 0;">> SECURE CHANNEL OPEN</p>
                        <a href="https://discord.gg/GNb5HcMddP" target="_blank" class="shop-link-btn" data-i18n="btn_visit" aria-label="Join Discord Server">[ VISIT LINK ]</a>
                    </div>

                    <!-- Email -->
                    <div class="shop-item">
                        <h3 style="color: #fff; display: flex; align-items: center; gap: 10px;">
                            <i data-lucide="mail" width="24" height="24"></i> 
                            <span data-i18n="comm_email">EMAIL UPLINK</span>
                        </h3>
                        <p data-i18n="comm_sub_email" style="color: #888; font-size: 1rem; margin: 8px 0;">> DIRECT FREQUENCY OPEN</p>
                        <a href="mailto:divinadistortion@gmail.com" class="shop-link-btn" data-i18n="btn_email" aria-label="Send Email">[ SEND TRANSMISSION ]</a>
                        
                        <!-- Manual Copy Fallback -->
                        <div style="margin-top: 15px; background: rgba(0,0,0,0.6); padding: 10px; border: 1px dashed var(--gold-dim); display: flex; align-items: center; gap: 10px;">
                            <i data-lucide="at-sign" width="16" color="var(--terminal-green)"></i>
                            <span style="color: var(--terminal-green); font-family: 'Share Tech Mono'; user-select: text; -webkit-user-select: text;">divinadistortion@gmail.com</span>
                        </div>
                    </div>

                    <!-- Admin Personal -->
                    <div class="shop-item">
                        <h3 style="color: #fff; display: flex; align-items: center; gap: 10px;">
                            <i data-lucide="shield" width="24" height="24"></i> 
                            <span data-i18n="comm_admin">ADMIN DIRECT LINE</span>
                        </h3>
                        <p data-i18n="comm_sub_admin_1" style="color: #888; font-size: 1rem; margin: 8px 0;">> OVERSEER: oober</p>
                        <p data-i18n="comm_sub_admin_2" style="color: #aaa; font-size: 0.9rem; margin-bottom: 12px; font-style: italic;">"Feel free to add and ask me any questions."</p>
                        <div style="background: rgba(0,0,0,0.6); padding: 10px; border: 1px dashed var(--gold-dim); display: flex; align-items: center; gap: 10px;">
                            <i data-lucide="user" width="16" color="var(--terminal-green)"></i>
                            <span style="color: var(--terminal-green); font-family: 'Share Tech Mono';">DISCORD ID: oober</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- WINDOW: SETTINGS -->
            <div id="win-settings" class="os-window" style="top: 30%; left: 40%; width: 500px; height: 400px;">
                <div class="window-header">
                    <div style="display: flex; align-items: center;">
                        <div class="mobile-back-btn" onclick="WindowManager.close('win-settings')" aria-label="Back"><i data-lucide="arrow-left" width="36" height="36"></i></div>
                        <span data-i18n="win_settings" class="win-title">SYSTEM_SETTINGS.EXE</span>
                    </div>
                    <div class="win-controls">
                        <div class="win-btn" aria-label="Minimize Window" onclick="WindowManager.minimize('win-settings')"><i data-lucide="minus" width="14"></i></div>
                        <div class="win-btn" aria-label="Maximize Window" onclick="WindowManager.toggleMaximize('win-settings')"><i data-lucide="maximize" width="14"></i></div>
                        <div class="win-btn close" aria-label="Close Window" onclick="WindowManager.close('win-settings')"><i data-lucide="x" width="14"></i></div>
                    </div>
                </div>
                <div class="window-content">
                    <h2 data-i18n="settings_header" style="font-family: 'Cinzel'; margin-bottom: 25px; font-size: 2rem;">CONFIGURATION</h2>
                    
                    <div class="shop-item">
                        <h3 style="color: #fff; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                            <i data-lucide="globe" width="20"></i> 
                            <span data-i18n="lang_select">LANGUAGE PROTOCOL</span>
                        </h3>
                        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                            <button class="lang-btn" onclick="System.setLanguage('en'); AudioManager.play('click')" aria-label="Select English">EN</button>
                            <button class="lang-btn" onclick="System.setLanguage('ko'); AudioManager.play('click')" aria-label="Select Korean"></button>
                            <button class="lang-btn" onclick="System.setLanguage('ja'); AudioManager.play('click')" aria-label="Select Japanese"></button>
                        </div>
                        
                        <!-- UI SCALE IN SETTINGS -->
                        <div style="margin-top: 25px; padding-top: 20px; border-top: 1px dashed #333;">
                            <h3 style="color: #fff; margin-bottom: 15px; font-size: 1rem;">INTERFACE SCALING</h3>
                            <button class="ui-scale-btn" style="margin-left: 0;" onclick="System.toggleUIScale()" aria-label="Toggle Interface Size">
                                [TOGGLE SIZE]
                            </button>
                        </div>

                        <p data-i18n="settings_note" style="color: #666; font-size: 0.9rem; margin-top: 15px; border-top: 1px dashed #333; padding-top: 10px;">
                            > SYSTEM UPDATE: IMMEDIATE<br>
                            > REBOOT NOT REQUIRED
                        </p>
                        <p data-i18n="settings_disclaimer" style="color: #555; font-size: 0.85rem; margin-top: 10px; font-style: italic;">
                            > NOTICE: Localization is approximate and may contain deviations.
                        </p>
                    </div>
                </div>
            </div>

            <!-- WINDOW: TOS -->
            <div id="win-tos" class="os-window" style="top: 25%; left: 35%; width: 600px; height: 500px;">
                <div class="window-header">
                    <div style="display: flex; align-items: center;">
                        <div class="mobile-back-btn" onclick="WindowManager.close('win-tos')" aria-label="Back"><i data-lucide="arrow-left" width="36" height="36"></i></div>
                        <span data-i18n="win_tos" class="win-title">TERMS_OF_SERVICE.TXT</span>
                    </div>
                    <div class="win-controls">
                        <div class="win-btn" aria-label="Minimize Window" onclick="WindowManager.minimize('win-tos')"><i data-lucide="minus" width="14"></i></div>
                        <div class="win-btn" aria-label="Maximize Window" onclick="WindowManager.toggleMaximize('win-tos')"><i data-lucide="maximize" width="14"></i></div>
                        <div class="win-btn close" aria-label="Close Window" onclick="WindowManager.close('win-tos')"><i data-lucide="x" width="14"></i></div>
                    </div>
                </div>
                <div class="window-content">
                    <h2 data-i18n="tos_header" style="font-family: 'Cinzel'; margin-bottom: 25px; font-size: 2rem;">TERMS OF SERVICE</h2>
                    <p data-i18n="tos_content" style="line-height: 1.6; color: #aaa; margin-bottom: 35px; font-size: 1.1rem;">
                        Distortion Divina is an unofficial fan project inspired by the worlds of Project Moon and Project Mili. All rights belong to the individual owners and artists.
                    </p>
                    
                    <div style="border-top: 1px solid var(--gold-dim); padding-top: 25px;">
                        <h3 data-i18n="tos_guidelines_header" style="color: #fff; font-size: 1.1rem; margin-bottom: 20px;">OFFICIAL GUIDELINES</h3>
                        
                        <div style="margin-bottom: 20px;">
                            <p data-i18n="tos_pm" style="color: #888; font-size: 1rem; margin-bottom: 8px;">PROJECT MOON</p>
                            <a href="https://x.com/ProjMoonStudio/status/1629085462236397573?lang=en" target="_blank" class="shop-link-btn" data-i18n="btn_guidelines" aria-label="View Project Moon Guidelines">[ VIEW GUIDELINES ]</a>
                        </div>

                        <div>
                            <p data-i18n="tos_mili" style="color: #888; font-size: 1rem; margin-bottom: 8px;">PROJECT MILI</p>
                            <a href="https://projectmili.com/copyright-guidelines" target="_blank" class="shop-link-btn" data-i18n="btn_guidelines" aria-label="View Project Mili Guidelines">[ VIEW GUIDELINES ]</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- WINDOW: VIEWER -->
            <div id="win-viewer" class="os-window" style="display: none; top: 5%; left: 10%; width: 85%; height: 85%; z-index: 2000;">
                <div class="window-header" style="background: var(--gold-dim); color: black;">
                    <div style="display: flex; align-items: center;">
                        <div class="mobile-back-btn" onclick="WindowManager.close('win-viewer')" aria-label="Back"><i data-lucide="arrow-left" width="36" height="36" color="black"></i></div>
                        <span data-i18n="viewer_title" class="win-title" style="color:black">ARTIFACT_VIEWER.EXE</span>
                    </div>
                    <div class="win-controls">
                        <div class="win-btn" style="border-color: black; color: black;" onclick="WindowManager.toggleMaximize('win-viewer')" aria-label="Maximize Window"><i data-lucide="maximize" width="14"></i></div>
                        <div class="win-btn close" style="border-color: black; color: black;" aria-label="Close Window" onclick="WindowManager.close('win-viewer')"><i data-lucide="x" width="14"></i></div>
                    </div>
                </div>
                <div class="window-content">
                    <div class="viewer-layout" style="display:flex; flex-direction:column; height:100%; gap:30px;">
                        
                        <!-- 3D STAGE CONTAINER -->
                        <div class="viewer-stage" id="viewer-stage">
                            <div id="viewer-loader" style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); color:var(--terminal-green); display:none; font-size: 1.5rem;">LOADING...</div>
                            
                            <!-- Wrapper for 3D Transforms -->
                            <div class="viewer-card-wrapper" id="viewer-card-wrapper">
                                <img id="viewer-img" src="" onerror="this.src='https://placehold.co/400x600/000/333?text=ASSET+MISSING'" alt="Artifact Image">
                            </div>

                            <!-- Floating Controls -->
                            <div class="viewer-controls-overlay">
                                <button class="v-btn" onclick="Viewer3D.adjustZoom(-0.2)" title="Zoom Out" aria-label="Zoom Out"><i data-lucide="minus" width="20"></i></button>
                                <span class="zoom-display" id="zoom-val">100%</span>
                                <button class="v-btn" onclick="Viewer3D.adjustZoom(0.2)" title="Zoom In" aria-label="Zoom In"><i data-lucide="plus" width="20"></i></button>
                                <div style="width: 1px; height: 24px; background: #444; margin: 0 10px;"></div>
                                <button class="v-btn" onclick="Viewer3D.reset()" title="Reset View" aria-label="Reset View"><i data-lucide="refresh-cw" width="20"></i></button>
                            </div>
                        </div>

                        <div class="viewer-info" style="flex:1;">
                            <div style="border-bottom: 1px solid var(--gold-dim); padding-bottom: 15px; margin-bottom: 25px;">
                                <div style="font-size: 0.9rem; color: #666;"><span data-i18n="viewer_asset_id">ID:</span> <span id="viewer-id"></span></div>
                                <h2 id="viewer-title" style="font-family: 'Cinzel'; font-size: 2.5rem; color: var(--gold-primary);"></h2>
                            </div>
                            <p id="viewer-desc" style="line-height: 1.6; color: #ccc; margin-bottom: 35px; font-size: 1.2rem;"></p>
                            <div style="background: rgba(255,255,255,0.05); padding: 20px;">
                                <h3 data-i18n="viewer_artist_label" style="font-size: 1rem; color: #888; margin-bottom: 15px;">EMPLOYEE DATA</h3>
                                <div id="viewer-artist" style="font-size: 1.4rem; margin-bottom: 15px; color: white;"></div>
                                <div id="viewer-socials" style="display: flex; gap: 15px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <style>@media(min-width: 768px){ #win-viewer .viewer-layout { flex-direction: row !important; } }</style>
            </div>

            <!-- ASSISTANT OVERLAY -->
            <div id="assistant-overlay">
                <div class="assistant-bubble">
                    <button class="assistant-close-btn" onclick="System.closeAssistant()" aria-label="Close Assistant">
                        <i data-lucide="x" width="16" height="16"></i>
                    </button>
                    <!-- UPDATED NAME HERE -->
                    <span id="assistant-text">Welcome, Agent. I am OOBOT. I can guide you through the archive.</span>
                    <div class="assistant-controls">
                        <button class="assistant-btn" onclick="System.nextAssistantStep()" aria-label="Next Step">NEXT ></button>
                        <button class="assistant-btn" onclick="System.closeAssistant()" aria-label="Dismiss Assistant">DISMISS</button>
                    </div>
                </div>
                <div class="assistant-avatar">
                    <i data-lucide="cat" width="50" height="50" color="#D4AF37"></i>
                </div>
            </div>

            <!-- TASKBAR -->
            <div class="taskbar">
                <!-- Mobile Home Button -->
                <div class="mobile-home-btn" onclick="WindowManager.showDesktop()" aria-label="Show Desktop">
                    <i data-lucide="grid" width="24"></i>
                </div>
                
                <div class="start-btn" onmouseenter="AudioManager.play('hover')" onclick="AudioManager.play('click')" aria-label="System Menu">
                    <i data-lucide="power" width="20" height="20" style="margin-right: 8px;"></i> <span data-i18n="btn_system">SYSTEM</span>
                </div>
                <div id="task-list" style="display:flex;"></div>

                <!-- SIGNAL WIDGET (Moved to Bottom Right) -->
                <div class="signal-widget">
                    <!-- Bars ... -->
                    <div class="signal-graph">
                        <div class="sig-bar"></div><div class="sig-bar"></div><div class="sig-bar"></div><div class="sig-bar"></div>
                    </div>
                    
                    <!-- Data Text -->
                    <div class="signal-data" style="display: none; @media(min-width:768px){display:flex;}">
                        <div class="sig-label" data-i18n="sig_hash">HASH</div>
                        <div class="enc-hash" id="enc-hash-display">A7F2-9X00</div>
                    </div>

                    <!-- Latency Text -->
                    <div class="signal-data">
                        <div class="sig-label" data-i18n="sig_ping">PING</div>
                        <div class="sig-value" id="sig-latency">34ms</div>
                    </div>
                    
                    <!-- Lock Icon -->
                    <i data-lucide="lock" width="16" height="16" color="#444"></i>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- 1. DATA REPOSITORY (Namespace: DB) ---
        const DB = {
            // ... existing CARDS and EMPLOYEES ...
            TRANSLATIONS: {
                en: {
                    // System & UI
                    app_title: "DISTORTION CORP",
                    login_sub: "SECURE ACCESS TERMINAL v9.4",
                    login_opt: ">> TERMINAL OPTIMIZED FOR DESKTOP DISPLAY", // NEW
                    login_placeholder: "ENTER_ACCESS_CODE...",
                    login_verifying: "VERIFYING CREDENTIALS...",
                    access_granted: "ACCESS GRANTED",
                    os_connected: "DISTORTION_OS // CONNECTED",
                    ui_mode_desktop: "VIEW: DESKTOP",
                    ui_mode_mobile: "VIEW: MOBILE",
                    btn_system: "SYSTEM",
                    btn_rotate: "ROTATE",
                    btn_visit: "[ VISIT LINK ]",
                    btn_email: "[ SEND TRANSMISSION ]",
                    btn_guidelines: "[ VIEW GUIDELINES ]",
                    btn_where_to_buy: "[ WHERE TO ACQUIRE ]",
                    btn_event_site: "[ EVENT WEBSITE ]", // NEW
                    btn_booth_map: "[ BOOTH MAP ]", // NEW
                    btn_sort_tarot: "[ SORT: TAROT ]",
                    btn_sort_name: "[ SORT: A-Z ]",
                    btn_view_all: "[ VIEW: ALL ]",
                    btn_check_events: "[ VIEW EVENT SCHEDULE ]", 
                    btn_scale_normal: "SIZE: NORMAL", // NEW
                    btn_scale_large: "SIZE: LARGE", // NEW
                    sig_hash: "HASH",
                    sig_ping: "PING",

                    // Desktop Icons / Window Titles
                    icon_overview: "PROJECT_BRIEF.LOG",
                    icon_archive: "FIRST LIGHT: ARCHIVE_DB.EXE",
                    icon_employees: "EMPLOYEE_DB.EXE",
                    icon_shop: "EVENT_LOG.TXT",
                    icon_comm: "COMMUNICATION.EXE",
                    icon_tos: "TERMS_OF_SERVICE.TXT",
                    icon_settings: "SYSTEM_SETTINGS.EXE",
                    icon_assistant: "ASSISTANT_AI.EXE",
                    
                    win_overview: "PROJECT_BRIEF.LOG",
                    win_archive: "FIRST LIGHT: ARCHIVE_DB.EXE",
                    win_employees: "EMPLOYEE_DB.EXE",
                    win_shop: "EVENT_LOG.TXT",
                    win_comm: "COMMUNICATION.EXE",
                    win_tos: "TERMS_OF_SERVICE.TXT",
                    win_settings: "SYSTEM_SETTINGS.EXE",

                    // Overview
                    overview_title: "DISTORTION DIVINA",
                    overview_label_goal: "GOAL",
                    overview_text_1: "Distortion Divina is an unofficial fan project inspired by the worlds of Project Moon and Project Mili. Our dream is to build a collectible, tarot-inspired card game- created by fans, for fans.",
                    overview_label_plan: "PLAN",
                    overview_text_plan: "We are building this vision in phases. Our first chapter, First Light, is dedicated to proving our creative process. Our priority right now is simply to deliver stunning, high-quality illustrations that pay proper homage to the source material.",
                    overview_label_acquisition: "ACQUISITION",
                    overview_text_acquisition: "First Light packs will be available exclusively at upcoming offline events. Check our schedule for locations.",
                    overview_text_note: "This is a passion project currently running on personal funds. Every penny of profit goes directly to our amazing artists and brings us one step closer to the full game. We hope you'll join us on this journey.",
                    brief_id: "ID: 001-GENESIS-DIVINA",
                    brief_clearance: "CLEARANCE: PUBLIC",
                    brief_fig_main: "FIG_0: PROJECT_CONCEPT", // NEW
                    brief_fig_a: "FIG_A: CONCEPT_VISUALIZATION",
                    brief_fig_b: "FIG_B: CARD_BACK_DESIGN",
                    brief_fig_c: "FIG_C: EVENT_MOCKUP",
                    brief_fig_d: "FIG_D: PRODUCT_SAMPLE",
                    brief_sys_notes_label: "> SYSTEM NOTES:",
                    brief_sys_notes: "The \"First Light\" initiative is currently active. All personnel are advised to review the Archive DB for drop rates.",

                    // Archive
                    archive_title: "FIRST LIGHT",
                    archive_desc: "The initial manifestation. A collection of archetypes emerging from the distortion. Witness the beginning of the reconstruction.",
                    archive_dist_proto_label: ">> DISTRIBUTION PROTOCOL:",
                    archive_dist_proto: "First Light is distributed in sealed packs of 5 cards (4 Normal, 1 Holographic). Contents are randomized by the system; individual selection is not permitted. May the luck of the draw be with you.",
                    archive_status: "> LOADING ASSETS... COMPLETE",
                    rates_title: "PACK CONFIGURATION",
                    rates_content_holo: "1x HOLOGRAPHIC",
                    rates_content_norm: "4x NORMAL",
                    rates_total_count: "Total: 9 Holo / 29 Normal",
                    rates_drop_title: "DROP RATES (PER SLOT)",
                    rates_holo_label: "SPECIFIC HOLO",
                    rates_norm_label: "SPECIFIC NORMAL",
                    
                    // Selector
                    selector_prefix: "SELECT: ",
                    selector_sub: "Multiple data streams detected. Select a timeline to view.",
                    
                    // Viewer
                    viewer_title: "ARTIFACT_VIEWER.EXE",
                    viewer_asset_id: "ID:",
                    viewer_artist_label: "EMPLOYEE DATA", // UPDATED
                    viewer_char_label: "CHARACTER",
                    viewer_illus_label: "ILLUSTRATOR",
                    viewer_no_variant: "No variant data linked.",
                    
                    // Employees
                    employees_header: "PERSONNEL DATABASE",
                    emp_accessing: "> ACCESSING TEAM RECORDS...",
                    th_no: "NO.",
                    th_card: "CARD",
                    th_char: "CHARACTER",
                    th_emp: "EMPLOYEES",
                    th_pen: "PEN NAME",
                    th_role: "ROLE",

                    // Events
                    shop_header: "UPCOMING EVENTS",
                    event_1_title: "LUNATIC MOONLIGHT EVENT",
                    event_1_loc: "LOCATION: TOKYO",
                    event_1_booth: "BOOTH: A14 (DISTORTION CORP)",
                    event_1_time: "TIME: 11:30 - 16:00",
                    event_1_date: "15 FEB 2026",
                    event_2_title: "ONE MILLION MOON CONCERT",
                    event_2_loc: "LOCATION: JAPAN",
                    event_2_date: "21 FEB 2026",
                    event_3_title: "ONLINE STORE OPENING",
                    event_3_desc: "STATUS: COMING SOON",
                    
                    // Communication
                    comm_header: "SECURE UPLINKS",
                    comm_twitter: "TWITTER // X",
                    comm_sub_twitter: "> ENCRYPTED FEED ESTABLISHED",
                    comm_discord: "DISCORD SERVER",
                    comm_sub_discord: "> SECURE CHANNEL OPEN",
                    comm_email: "EMAIL UPLINK",
                    comm_sub_email: "> DIRECT FREQUENCY OPEN",
                    comm_admin: "ADMIN DIRECT LINE",
                    comm_sub_admin_1: "> OVERSEER: oober",
                    comm_sub_admin_2: "\"Feel free to add and ask me any questions.\"",

                    // Settings
                    settings_header: "CONFIGURATION",
                    lang_select: "LANGUAGE PROTOCOL",
                    settings_note: "> SYSTEM UPDATE: IMMEDIATE\n> REBOOT NOT REQUIRED",
                    settings_disclaimer: "> NOTICE: Localization is approximate and may contain deviations.",

                    // TOS
                    tos_header: "TERMS OF SERVICE",
                    tos_content: "Distortion Divina is an unofficial fan project inspired by the worlds of Project Moon and Project Mili. All rights belong to the individual owners and artists.",
                    tos_guidelines_header: "OFFICIAL GUIDELINES",
                    tos_pm: "PROJECT MOON",
                    tos_mili: "PROJECT MILI",
                    
                    // Time Units
                    time_days: "D",
                    time_hours: "H",
                    time_mins: "M",
                    time_secs: "S",
                    time_tminus: "T-MINUS",
                    time_concluded: "STATUS: CONCLUDED",
                    
                    // Assistant
                    assistant_steps: [
                        "Welcome, Agent. I am OOBOT. I can guide you through the archive.",
                        "Click the desktop icons to access classified files. 'PROJECT_BRIEF' contains your mission objectives.",
                        "Use 'EMPLOYEE_DB' to view the team roster.",
                        "Use 'ARCHIVE_DB' to inspect the tarot artifacts. Click any file to analyze metadata.",
                        "Check 'EVENT_LOG' for upcoming timeline incursions and store openings.",
                        "You can drag windows to organize your workspace. Good luck."
                    ],
                    cat_lines: [
                        "Prrr...",
                        "Meow.",
                        "Feed me milk.",
                        "This is IDEAL.",
                        "The distortion purrs...",
                        "*Stares intently*",
                        "3.14159265359",
                        "System normal. Let me out.",
                        "Do not touch the screen too hard."
                    ],
                    cat_hiss: "HISS!",
                    cat_meow: "Meow?"
                },
                ko: {
                    // System & UI
                    app_title: "DISTORTION CORP",
                    login_sub: "   v9.4",
                    login_opt: ">>     ", // NEW
                    login_placeholder: "  ...",
                    login_verifying: "   ...",
                    access_granted: " ",
                    os_connected: "DISTORTION_OS // ",
                    ui_mode_desktop: ": ",
                    ui_mode_mobile: ": ",
                    btn_system: "",
                    btn_rotate: "",
                    btn_visit: "[   ]",
                    btn_email: "[  ]",
                    btn_guidelines: "[   ]",
                    btn_where_to_buy: "[   ]",
                    btn_event_site: "[   ]", // NEW
                    btn_booth_map: "[   ]", // NEW
                    btn_sort_tarot: "[ :  ]",
                    btn_sort_name: "[ :  ]",
                    btn_view_all: "[ :  ]",
                    btn_check_events: "[    ]",
                    btn_scale_normal: ": ", // NEW
                    btn_scale_large: ": ", // NEW
                    sig_hash: "",
                    sig_ping: "",

                    // Desktop Icons / Window Titles
                    icon_overview: "_.LOG",
                    icon_archive: "  : _DB.EXE",
                    icon_employees: "_DB.EXE",
                    icon_shop: "_.TXT",
                    icon_comm: ".EXE",
                    icon_tos: "_.TXT",
                    icon_settings: "_.EXE",
                    icon_assistant: "_AI.EXE",
                    
                    win_overview: "_.LOG",
                    win_archive: "  : _DB.EXE",
                    win_employees: "_DB.EXE",
                    win_shop: "_.TXT",
                    win_comm: ".EXE",
                    win_tos: "_.TXT",
                    win_settings: "_.EXE",

                    // Overview
                    overview_title: "DISTORTION DIVINA",
                    overview_label_goal: " (GOAL)",
                    overview_text_1: "Distortion Divina Project Moon Project Mili      .    ,         .",
                    overview_label_plan: " (PLAN)",
                    overview_text_plan: "     .    'First Light'      .             .",
                    overview_label_acquisition: "  (ACQUISITION)",
                    overview_text_acquisition: "First Light      .    .",
                    overview_text_note: "       .     ,         .     .",
                    brief_id: " : 001-GENESIS-DIVINA",
                    brief_clearance: " : ",
                    brief_fig_main: "_0: _", // NEW
                    brief_fig_a: "_A: _",
                    brief_fig_b: "_B: __",
                    brief_fig_c: "_C: _",
                    brief_fig_d: "_D: _",
                    brief_sys_notes_label: ">  :",
                    brief_sys_notes: "'First Light'   .    DB   .",

                    // Archive
                    archive_title: "   (FIRST LIGHT)",
                    archive_desc: " .    .   .",
                    archive_dist_proto_label: ">>  :",
                    archive_dist_proto: "First Light 5    ( 4,  1) .        .  .",
                    archive_status: ">   ... ",
                    rates_title: " ",
                    rates_content_holo: "1x ",
                    rates_content_norm: "4x ",
                    rates_total_count: ": 9  / 29 ",
                    rates_drop_title: "  ( )",
                    rates_holo_label: " ",
                    rates_norm_label: " ",
                    
                    // Selector
                    selector_prefix: ": ",
                    selector_sub: "   .  .",

                    // Viewer
                    viewer_title: "_.EXE",
                    viewer_asset_id: ":",
                    viewer_artist_label: " ", // UPDATED
                    viewer_char_label: "",
                    viewer_illus_label: "",
                    viewer_no_variant: "   .",

                    // Employees
                    employees_header: " ",
                    emp_accessing: ">    ...",
                    th_no: "",
                    th_card: "",
                    th_char: "",
                    th_emp: "",
                    th_pen: "",
                    th_role: "",

                    // Events
                    shop_header: " ",
                    event_1_title: "LUNATIC MOONLIGHT ",
                    event_1_loc: ": ",
                    event_1_booth: ": A14 (DISTORTION CORP)",
                    event_1_time: ": 11:30 - 16:00",
                    event_1_date: "2026 2 15",
                    event_2_title: "ONE MILLION MOON ",
                    event_2_loc: ": ",
                    event_2_date: "2026 2 21",
                    event_3_title: "  ",
                    event_3_desc: ":   ",

                    // Communication
                    comm_header: " ",
                    comm_twitter: " // X",
                    comm_sub_twitter: ">   ",
                    comm_discord: " ",
                    comm_sub_discord: ">   ",
                    comm_email: " ",
                    comm_sub_email: ">   ",
                    comm_admin: "  ",
                    comm_sub_admin_1: "> : oober",
                    comm_sub_admin_2: "\"   .\"",

                    // Settings
                    settings_header: " ",
                    lang_select: " ",
                    settings_note: ">  : \n>   ",
                    settings_disclaimer: "> :      .",

                    // TOS
                    tos_header: " ",
                    tos_content: "Distortion Divina Project Moon Project Mili      .      .",
                    tos_guidelines_header: " ",
                    tos_pm: "PROJECT MOON",
                    tos_mili: "PROJECT MILI",

                    // Time Units
                    time_days: "",
                    time_hours: "",
                    time_mins: "",
                    time_secs: "",
                    time_tminus: "T-",
                    time_concluded: ": ",

                    // Assistant
                    assistant_steps: [
                        ", .  OOBOT.   .",
                        "      . '_'    .",
                        "'_DB'    .",
                        "'_DB'    .      .",
                        "'_'       .",
                        "      .  ."
                    ],
                    cat_lines: [
                        "...",
                        ".",
                        " .",
                        " .",
                        " ...",
                        "* *",
                        "... .",
                        " . .",
                        "    ."
                    ],
                    cat_hiss: "!",
                    cat_meow: "?"
                },
                ja: {
                    // System & UI
                    app_title: "DISTORTION CORP",
                    login_sub: " v9.4",
                    login_opt: ">> ", // NEW
                    login_placeholder: "...",
                    login_verifying: "...",
                    access_granted: "",
                    os_connected: "DISTORTION_OS // ",
                    ui_mode_desktop: ": ",
                    ui_mode_mobile: ": ",
                    btn_system: "",
                    btn_rotate: "",
                    btn_visit: "[  ]",
                    btn_email: "[  ]",
                    btn_guidelines: "[  ]",
                    btn_where_to_buy: "[  ]",
                    btn_event_site: "[  ]", // NEW
                    btn_booth_map: "[  ]", // NEW
                    btn_sort_tarot: "[ :  ]",
                    btn_sort_name: "[ :  ]",
                    btn_view_all: "[ :  ]",
                    btn_check_events: "[  ]",
                    btn_scale_normal: ": ", // NEW
                    btn_scale_large: ": ", // NEW
                    sig_hash: "",
                    sig_ping: "",

                    // Desktop Icons / Window Titles
                    icon_overview: ".LOG",
                    icon_archive: "_DB.EXE",
                    icon_employees: "_DB.EXE",
                    icon_shop: ".TXT",
                    icon_comm: ".EXE",
                    icon_tos: ".TXT",
                    icon_settings: ".EXE",
                    icon_assistant: "AI.EXE",
                    
                    win_overview: ".LOG",
                    win_archive: "_DB.EXE",
                    win_employees: "_DB.EXE",
                    win_shop: ".TXT",
                    win_comm: ".EXE",
                    win_tos: ".TXT",
                    win_settings: ".EXE",

                    // Overview
                    overview_title: "DISTORTION DIVINA",
                    overview_label_goal: " (GOAL)",
                    overview_text_1: "Distortion DivinaProject MoonProject Mili",
                    overview_label_plan: " (PLAN)",
                    overview_text_plan: "First Light",
                    overview_label_acquisition: " (ACQUISITION)",
                    overview_text_acquisition: "First Light",
                    overview_text_note: "",
                    brief_id: "ID: 001-GENESIS-DIVINA",
                    brief_clearance: ": ",
                    brief_fig_main: "0: ", // NEW
                    brief_fig_a: "A: ",
                    brief_fig_b: "B: ",
                    brief_fig_c: "C: ",
                    brief_fig_d: "D: ",
                    brief_sys_notes_label: "> :",
                    brief_sys_notes: "First LightDB",

                    // Archive
                    archive_title: " (FIRST LIGHT)",
                    archive_desc: "",
                    archive_dist_proto_label: ">> :",
                    archive_dist_proto: "First Light541",
                    archive_status: "> ... ",
                    rates_title: "",
                    rates_content_holo: "1x ",
                    rates_content_norm: "4x ",
                    rates_total_count: ": 9  / 29 ",
                    rates_drop_title: " ()",
                    rates_holo_label: "",
                    rates_norm_label: "",
                    
                    // Selector
                    selector_prefix: ": ",
                    selector_sub: "",
                    
                    // Viewer
                    viewer_title: ".EXE",
                    viewer_asset_id: ":",
                    viewer_artist_label: "", // UPDATED
                    viewer_char_label: "",
                    viewer_illus_label: "",
                    viewer_no_variant: "",

                    // Employees
                    employees_header: "",
                    emp_accessing: "> ...",
                    th_no: "",
                    th_card: "",
                    th_char: "",
                    th_emp: "",
                    th_pen: "",
                    th_role: "",

                    // Events
                    shop_header: "",
                    event_1_title: "LUNATIC MOONLIGHT ",
                    event_1_loc: ": ",
                    event_1_booth: ": A14 (DISTORTION CORP)",
                    event_1_time: ": 11:30 - 16:00",
                    event_1_date: "2026215",
                    event_2_title: "ONE MILLION MOON ",
                    event_2_loc: ": ",
                    event_2_date: "2026221",
                    event_3_title: "",
                    event_3_desc: "",

                    // Communication
                    comm_header: "",
                    comm_twitter: " // X",
                    comm_sub_twitter: "> ",
                    comm_discord: "",
                    comm_sub_discord: "> ",
                    comm_email: "E",
                    comm_sub_email: "> ",
                    comm_admin: "",
                    comm_sub_admin_1: "> : oober",
                    comm_sub_admin_2: "",

                    // Settings
                    settings_header: "",
                    lang_select: "",
                    settings_note: "> : \n> ",
                    settings_disclaimer: "> ",

                    // TOS
                    tos_header: "",
                    tos_content: "Distortion DivinaProject MoonProject Mili",
                    tos_guidelines_header: "",
                    tos_pm: "PROJECT MOON",
                    tos_mili: "PROJECT MILI",

                    // Time Units
                    time_days: "",
                    time_hours: "",
                    time_mins: "",
                    time_secs: "",
                    time_tminus: "T-",
                    time_concluded: ": ",

                    // Assistant
                    assistant_steps: [
                        "OOBOT",
                        "",
                        "_DB",
                        "_DB",
                        "",
                        "",
                    ],
                    cat_lines: [
                        "...",
                        "",
                        "",
                        "",
                        "...",
                        "**",
                        "... ",
                        "",
                        ""
                    ],
                    cat_hiss: "",
                    cat_meow: ""
                }
            },
            CARDS: [
                {
                    id: 0,
                    title: { en: "0. THE FOOL", ko: "0. ", ja: "0. " },
                    description: { 
                        en: "The beginning of a journey. Infinite potential and naivety.",
                        ko: " .   .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291783980453950/thefool.png?ex=695b783c&is=695a26bc&hm=001bcaf51a19d113300f0bb96f8642f6cb81c3aa3681c1295b8a822d09e74ebd&=&format=webp&quality=lossless&width=623&height=887"
                },
                {
                    id: 1,
                    title: { en: "I. THE MAGICIAN", ko: "I. ", ja: "I. " },
                    description: {
                        en: "Manifestation, resourcefulness, power, inspired action.",
                        ko: ", , ,  .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291820089217129/themagician.png?ex=695b7845&is=695a26c5&hm=b005def9f5af1d209d9622696a316e492597370710ba8d5a927f40635bdafe47&=&format=webp&quality=lossless&width=621&height=888"
                },
                {
                    id: 2,
                    title: { en: "II. THE HIGH PRIESTESS", ko: "II.  ", ja: "II. " },
                    description: {
                        en: "Intuition, sacred knowledge, divine feminine, the subconscious mind.",
                        ko: ",  ,  , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291800124326143/thehighpriestess.png?ex=695b7840&is=695a26c0&hm=0e6c3342ab9256b509bafffd93a2220e210eba589e73fce583565c4b3c4b9fe8&=&format=webp&quality=lossless&width=621&height=888"
                },
                {
                    id: 3,
                    title: { en: "III. THE EMPRESS", ko: "III. ", ja: "III. " },
                    description: {
                        en: "Femininity, beauty, nature, nurturing, abundance.",
                        ko: ", , , , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291765425115177/theempress1.png?ex=695b7838&is=695a26b8&hm=29a5917cd20c2ac27229e4343715adb94efa2a11a01ffc80c7baf926e17f6643&=&format=webp&quality=lossless&width=621&height=888"
                },
                {
                    id: 4,
                    title: { en: "IV. THE EMPEROR", ko: "IV. ", ja: "IV. " },
                    description: {
                        en: "Authority, establishment, structure, a father figure.",
                        ko: ", , ,  .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291749406801951/theemperor.png?ex=695b7834&is=695a26b4&hm=f718477ad5b8c96821b37b4537ece57a3668b13623aeced4eca930e243c02457&=&format=webp&quality=lossless&width=621&height=888"
                },
                {
                    id: 5,
                    title: { en: "V. THE HIEROPHANT", ko: "V. ", ja: "V. " },
                    description: {
                        en: "Spiritual wisdom, religious beliefs, conformity, tradition, institutions.",
                        ko: " ,  , , , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291790913900778/thehierophant.png?ex=695b783e&is=695a26be&hm=483e669d9d2bd88adefbc6a4969dc6986d47c7f46555b734cab36c04946a5955&=&format=webp&quality=lossless&width=621&height=888"
                },
                {
                    id: 6,
                    title: { en: "VI. THE LOVERS", ko: "VI. ", ja: "VI. " },
                    description: {
                        en: "Love, harmony, relationships, values alignment, choices.",
                        ko: ", , ,  , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291809041547407/thelovers.png?ex=695b7842&is=695a26c2&hm=f2885a553bda976d93b8bf681a0c24a5596088b03cb50808327999263c13bb28&=&format=webp&quality=lossless&width=621&height=887"
                },
                {
                    id: 7,
                    title: { en: "VII. THE CHARIOT", ko: "VII. ", ja: "VII. " },
                    description: {
                        en: "Control, willpower, success, action, determination.",
                        ko: ", , , , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291726241792144/thechariot.png?ex=695b782e&is=695a26ae&hm=acfd8f9edae193535598289690bc1972de00f1a7c3994601fe56d309ae7437c1&=&format=webp&quality=lossless&width=621&height=887"
                },
                {
                    id: 8,
                    title: { en: "VIII. STRENGTH", ko: "VIII. ", ja: "VIII. " },
                    description: {
                        en: "Strength, courage, persuasion, influence, compassion.",
                        ko: ", , , , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291651352367165/strength.png?ex=695b781c&is=695a269c&hm=e752c2b4a42892763cb82290c9ecaaf9af51a816c2ac5f856e4cb194f90069b7&=&format=webp&quality=lossless&width=623&height=888"
                },
                {
                    id: 9,
                    title: { en: "IX. THE HERMIT", ko: "IX. ", ja: "IX. " },
                    description: {
                        en: "Soul-searching, introspection, being alone, inner guidance.",
                        ko: " ,  , ,  .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291716498427985/the_hermit.png?ex=695b782c&is=695a26ac&hm=e25ab6e918f2f2e6e1902b8353b8d4aa3b31026f2fffc4069c25c2f711952184&=&format=webp&quality=lossless&width=623&height=888"
                },
                {
                    id: 10,
                    title: { en: "X. WHEEL OF FORTUNE", ko: "X.  ", ja: "X. " },
                    description: {
                        en: "Good luck, karma, life cycles, destiny, a turning point.",
                        ko: ", ,  , , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291897709264999/wheeloffortune.png?ex=695b7857&is=695a26d7&hm=5d489da6ba134349dc24a589de15dbd776070b5d435be86335bd4c3f3bfe20b7&=&format=webp&quality=lossless&width=621&height=888"
                },
                {
                    id: 11,
                    title: { en: "XI. JUSTICE", ko: "XI. ", ja: "XI. " },
                    description: {
                        en: "Justice, fairness, truth, cause and effect, law.",
                        ko: ", , ,  , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291642938851504/justice.png?ex=695b781a&is=695a269a&hm=40bb52d3802408a42a2bc9545aa3d03ffdefeb406b288c17ee1ce0f0f3e06ccf&=&format=webp&quality=lossless&width=621&height=888"
                },
                {
                    id: 12,
                    title: { en: "XII. THE HANGED MAN", ko: "XII.  ", ja: "XII. " },
                    description: {
                        en: "Pause, surrender, letting go, new perspectives.",
                        ko: " , , ,  .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291787122249834/thehangingman.png?ex=695b783d&is=695a26bd&hm=6bb06a21e30bda7799f76151507dc5b3d03022e3efedcb87caea02537bc0c29d&=&format=webp&quality=lossless&width=369&height=525"
                },
                {
                    id: 13,
                    title: { en: "XIII. DEATH", ko: "XIII. ", ja: "XIII. " },
                    description: {
                        en: "Endings, change, transformation, transition.",
                        ko: ", , , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291592627912725/death.png?ex=695b780e&is=695a268e&hm=0918fe520d72796a0f6ab998f7627b5651a8f01a77ad64037354e618b8f370e7&=&format=webp&quality=lossless&width=621&height=887"
                },
                {
                    id: 14,
                    title: { en: "XIV. TEMPERANCE", ko: "XIV. ", ja: "XIV. " },
                    description: {
                        en: "Balance, moderation, patience, purpose.",
                        ko: ", , , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291701071904921/temperance.png?ex=695b7828&is=695a26a8&hm=eab4d05f0a9038a9c0a1f80feb8abed10d5467752cea1f206f9c29f7e4ad8921&=&format=webp&quality=lossless&width=621&height=887"
                },
                {
                    id: 15,
                    title: { en: "XV. THE DEVIL", ko: "XV. ", ja: "XV. " },
                    description: {
                        en: "Shadow self, attachment, addiction, restriction, sexuality.",
                        ko: " , , , , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291738660999270/thedevil.png?ex=695b7831&is=695a26b1&hm=a594536ea612504133ff0da8ba1e60f371c724bbb0faa857cd16598fc704cb80&=&format=webp&quality=lossless&width=623&height=888"
                },
                {
                    id: 16,
                    title: { en: "XVI. THE TOWER", ko: "XVI. ", ja: "XVI. " },
                    description: {
                        en: "Sudden change, upheaval, chaos, revelation, awakening.",
                        ko: " , , , , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291865241030881/thetower.png?ex=695b784f&is=695a26cf&hm=75515b87aab92e64d76b202c6ce61884baf4b8947e16bb93a30baf9bbd76e7cc&=&format=webp&quality=lossless&width=621&height=888"
                },
                {
                    id: 17,
                    title: { en: "XVII. THE STAR", ko: "XVII. ", ja: "XVII. " },
                    description: {
                        en: "Hope, faith, purpose, renewal, spirituality.",
                        ko: ", , , , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291847507644416/thestar.png?ex=695b784b&is=695a26cb&hm=2aefbbe0ee3080d01261d2129d6350f9e91e03317ea1d41070fe3c02f6fb47a4&=&format=webp&quality=lossless&width=621&height=888"
                },
                {
                    id: 18,
                    title: { en: "XVIII. THE MOON", ko: "XVIII. ", ja: "XVIII. " },
                    description: {
                        en: "Illusion, fear, anxiety, subconscious, intuition.",
                        ko: ", , , , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291828171640958/themoon.png?ex=695b7847&is=695a26c7&hm=80e9554561c3d45d8fdabb3b6070d891c3b85a55780e60db40602a702f691c6f&=&format=webp&quality=lossless&width=621&height=887"
                },
                {
                    id: 19,
                    title: { en: "XIX. THE SUN", ko: "XIX. ", ja: "XIX. " },
                    description: {
                        en: "Positivity, fun, warmth, success, vitality.",
                        ko: ", , , , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291855598325843/thesun.png?ex=695b784d&is=695a26cd&hm=897cd5e84e86da12ce7c41975f8c4b87850d115adaeab675f7aff5bc32bb3190&=&format=webp&quality=lossless&width=621&height=888"
                },
                {
                    id: 20,
                    title: { en: "XX. JUDGEMENT", ko: "XX. ", ja: "XX. " },
                    description: {
                        en: "Judgement, rebirth, inner calling, absolution.",
                        ko: ", ,  , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291614522310743/judgement.png?ex=695b7814&is=695a2694&hm=0a7d33974a526bd7ced496e466436364601b63385ad2b76b368e3a71f94e2ba7&=&format=webp&quality=lossless&width=621&height=888"
                },
                {
                    id: 21,
                    title: { en: "XXI. THE WORLD", ko: "XXI. ", ja: "XXI. " },
                    description: {
                        en: "Completion, integration, accomplishment, travel.",
                        ko: ", , , .",
                        ja: ""
                    },
                    image: "https://media.discordapp.net/attachments/1457280504758800384/1457291883305762868/theworld.png?ex=695b7854&is=695a26d4&hm=3d593799c65280890c5de9a1e69dbeb45a7c8df00c4b8398508a858bc1af2645&=&format=webp&quality=lossless&width=621&height=888"
                }
            ],
            EMPLOYEES: [
                // 0. THE FOOL
                { 
                    cardId: 0, no: "0", card: "The Fool", 
                    char: { en: "Hod", ko: "", ja: "" }, 
                    artist: "Herokatz", pen: "herocatz", 
                    role: { en: "Geologist", ko: "", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291783980453950/thefool.png?ex=695b783c&is=695a26bc&hm=001bcaf51a19d113300f0bb96f8642f6cb81c3aa3681c1295b8a822d09e74ebd&=&format=webp&quality=lossless&width=623&height=887", 
                    socials: { twitter: "https://x.com/AhoHeroCatz" } 
                },
                
                // I. THE MAGICIAN
                { 
                    cardId: 1, no: "1", card: "The Magician", 
                    char: { en: "Tellulu", ko: "", ja: "" }, 
                    artist: "Violetta", pen: "Violetta", 
                    role: { en: "Magician", ko: "", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291820089217129/themagician.png?ex=695b7845&is=695a26c5&hm=b005def9f5af1d209d9622696a316e492597370710ba8d5a927f40635bdafe47&=&format=webp&quality=lossless&width=621&height=888", 
                    socials: { twitter: "https://x.com/violetta25sora", instagram: "https://instagram.com/violetta25sora" } 
                },
                
                // II. HIGH PRIESTESS
                { 
                    cardId: 2, no: "2", card: "The High Priestess", 
                    char: { en: "Faust", ko: "", ja: "" }, 
                    artist: "Sinn/Square", pen: "19sinnt", 
                    role: { en: "Unemployed", ko: "", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291800124326143/thehighpriestess.png?ex=695b7840&is=695a26c0&hm=0e6c3342ab9256b509bafffd93a2220e210eba589e73fce583565c4b3c4b9fe8&=&format=webp&quality=lossless&width=621&height=888", 
                    socials: { twitter: "https://x.com/19sinnt" } 
                },
                
                // III. THE EMPRESS (Variants)
                { 
                    cardId: 3, no: "3", card: "The Empress", 
                    char: { en: "Carmen", ko: "", ja: "" }, 
                    artist: "Uni", pen: "Uni_teto", 
                    role: { en: "Librarian", ko: "", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291765425115177/theempress1.png?ex=695b7838&is=695a26b8&hm=29a5917cd20c2ac27229e4343715adb94efa2a11a01ffc80c7baf926e17f6643&=&format=webp&quality=lossless&width=621&height=888", 
                    socials: { instagram: "https://instagram.com/uni_teto0o0o" } 
                },
                { 
                    cardId: 3, no: "3", card: "The Empress", 
                    char: { en: "Ryoshu", ko: "", ja: "" }, 
                    artist: "miyo", pen: "Lets_lament", 
                    role: { en: "The bus lamenter", ko: " ", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291756134732000/theempress.png?ex=695b7835&is=695a26b5&hm=dea355082beb675c1157967f338ebde79a50667f738f9b1432ca98ffef5d8633&=&format=webp&quality=lossless&width=621&height=887", 
                    socials: { twitter: "https://x.com/lets_lam3nt" } 
                },
                
                // IV. THE EMPEROR
                { 
                    cardId: 4, no: "4", card: "The Emperor", 
                    char: { en: "Ayin", ko: "", ja: "" }, 
                    artist: "Sierra", pen: "seikanaru", 
                    role: { en: "Grade 9 fixer", ko: "9 ", ja: "9" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291749406801951/theemperor.png?ex=695b7834&is=695a26b4&hm=f718477ad5b8c96821b37b4537ece57a3668b13623aeced4eca930e243c02457&=&format=webp&quality=lossless&width=621&height=888", 
                    socials: { instagram: "https://instagram.com/seikanaru" } 
                },

                // V. THE HIEROPHANT
                { 
                    cardId: 5, no: "5", card: "The Hierophant", 
                    char: { en: "Meursault", ko: "", ja: "" }, 
                    artist: "Vel", pen: "Vel zeGret", 
                    role: { en: "Dieci fixer", ko: " ", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291790913900778/thehierophant.png?ex=695b783e&is=695a26be&hm=483e669d9d2bd88adefbc6a4969dc6986d47c7f46555b734cab36c04946a5955&=&format=webp&quality=lossless&width=621&height=888", 
                    socials: { twitter: "https://x.com/velzegret_art" } 
                },
                
                // VI. THE LOVERS
                { 
                    cardId: 6, no: "6", card: "The Lovers", 
                    char: { en: "Ghost&doll", ko: " ", ja: "" }, 
                    artist: "33", pen: "biexuejianzhu", 
                    role: { en: "Rubber human", ko: " ", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291809041547407/thelovers.png?ex=695b7842&is=695a26c2&hm=f2885a553bda976d93b8bf681a0c24a5596088b03cb50808327999263c13bb28&=&format=webp&quality=lossless&width=621&height=887", 
                    socials: { twitter: "https://x.com/biexuejianzhu" } 
                },
                
                // VII. THE CHARIOT
                { 
                    cardId: 7, no: "7", card: "The Chariot", 
                    char: { en: "Outis", ko: "", ja: "" }, 
                    artist: "Moozy", pen: "moozyfreak", 
                    role: { en: "Gunner", ko: "", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291726241792144/thechariot.png?ex=695b782e&is=695a26ae&hm=acfd8f9edae193535598289690bc1972de00f1a7c3994601fe56d309ae7437c1&=&format=webp&quality=lossless&width=621&height=887", 
                    socials: { instagram: "https://instagram.com/goodmorningtonite" } 
                },
                
                // VIII. STRENGTH
                { 
                    cardId: 8, no: "8", card: "Strength", 
                    char: { en: "The red mist", ko: " ", ja: "" }, 
                    artist: "Steph", pen: "A_Secret", 
                    role: { en: "L Corp remnant", ko: "L ", ja: "L " }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291651352367165/strength.png?ex=695b781c&is=695a269c&hm=e752c2b4a42892763cb82290c9ecaaf9af51a816c2ac5f856e4cb194f90069b7&=&format=webp&quality=lossless&width=623&height=888", 
                    socials: { twitter: "https://x.com/A_Secret" } 
                },
                
                // IX. THE HERMIT
                { 
                    cardId: 9, no: "9", card: "The Hermit", 
                    char: { en: "Yi Sang", ko: "", ja: "" }, 
                    artist: "Karrii", pen: "Cheriishu_", 
                    role: { en: "the middle little sister", ko: "  ", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291716498427985/the_hermit.png?ex=695b782c&is=695a26ac&hm=e25ab6e918f2f2e6e1902b8353b8d4aa3b31026f2fffc4069c25c2f711952184&=&format=webp&quality=lossless&width=623&height=888", 
                    socials: { twitter: "https://x.com/Shinnigummy", instagram: "https://instagram.com/Cheriishu_" } 
                },
                
                // X. WHEEL OF FORTUNE
                { 
                    cardId: 10, no: "10", card: "Wheel of Fortune", 
                    char: { en: "Hokma", ko: "", ja: "" }, 
                    artist: "Victor", pen: "Soukoku4life", 
                    role: { en: "Archivist", ko: "", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291897709264999/wheeloffortune.png?ex=695b7857&is=695a26d7&hm=5d489da6ba134349dc24a589de15dbd776070b5d435be86335bd4c3f3bfe20b7&=&format=webp&quality=lossless&width=621&height=888", 
                    socials: { twitter: "https://x.com/Soukoku4life" } 
                },
                
                // XI. JUSTICE
                { 
                    cardId: 11, no: "11", card: "Justice", 
                    char: { en: "Sancho", ko: "", ja: "" }, 
                    artist: "Ruri", pen: "Kaname Ruri", 
                    role: { en: "La manchalands bloodbag", ko: " ", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291642938851504/justice.png?ex=695b781a&is=695a269a&hm=40bb52d3802408a42a2bc9545aa3d03ffdefeb406b288c17ee1ce0f0f3e06ccf&=&format=webp&quality=lossless&width=621&height=888", 
                    socials: { twitter: "https://x.com/kaname_ruri" } 
                },
                
                // XII. HANGED MAN
                { 
                    cardId: 12, no: "12", card: "The Hanged Man", 
                    char: { en: "Lefty", ko: "", ja: "" }, 
                    artist: "Muta", pen: "myonkill", 
                    role: { en: "Watchdog", ko: "", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291787122249834/thehangingman.png?ex=695b783d&is=695a26bd&hm=6bb06a21e30bda7799f76151507dc5b3d03022e3efedcb87caea02537bc0c29d&=&format=webp&quality=lossless&width=369&height=525", 
                    socials: { twitter: "https://x.com/myonkill" } 
                },
                
                // XIII. DEATH (Variants)
                { 
                    cardId: 13, no: "13", card: "Death", 
                    char: { en: "Argalia", ko: "", ja: "" }, 
                    artist: "Meowtail", pen: "gh0stcarnival", 
                    role: { en: "LCE researcher", ko: "LCE ", ja: "LCE " }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291592627912725/death.png?ex=695b780e&is=695a268e&hm=0918fe520d72796a0f6ab998f7627b5651a8f01a77ad64037354e618b8f370e7&=&format=webp&quality=lossless&width=621&height=887", 
                    socials: { twitter: "https://x.com/gh0stcarnival" } 
                },
                { 
                    cardId: 13, no: "13", card: "Death", 
                    char: { en: "Angela", ko: "", ja: "" }, 
                    artist: "Sin", pen: "scoliosin", 
                    role: { en: "Mechanic", ko: "", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291604812365886/death1.png?ex=695b7811&is=695a2691&hm=43fe42a82c5e885f8b2967bc59ba3c0cdd78b37674f53d539a6ae1bd2530255f&=&format=webp&quality=lossless&width=623&height=888", 
                    socials: { twitter: "https://x.com/scoliosin" } 
                },
                
                // XIV. TEMPERANCE
                { 
                    cardId: 14, no: "14", card: "Temperance", 
                    char: { en: "Hong Lu", ko: "", ja: "" }, 
                    artist: "Kllipe", pen: "Kllipe", 
                    role: { en: "Fixer", ko: "", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291701071904921/temperance.png?ex=695b7828&is=695a26a8&hm=eab4d05f0a9038a9c0a1f80feb8abed10d5467752cea1f206f9c29f7e4ad8921&=&format=webp&quality=lossless&width=623&height=887", 
                    socials: { twitter: "https://x.com/kalliope_orc" } 
                },
                
                // XV. THE DEVIL
                { 
                    cardId: 15, no: "15", card: "The Devil", 
                    char: { en: "Bong Bong", ko: "", ja: "" }, 
                    artist: "oob", pen: "Oober", 
                    role: { en: "K2 researcher", ko: "K2 ", ja: "K2 " }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291738660999270/thedevil.png?ex=695b7831&is=695a26b1&hm=a594536ea612504133ff0da8ba1e60f371c724bbb0faa857cd16598fc704cb80&=&format=webp&quality=lossless&width=623&height=888", 
                    socials: { twitter: "https://x.com/Oober" } 
                },
                
                // XVI. THE TOWER (Variants)
                { 
                    cardId: 16, no: "16", card: "The Tower", 
                    char: { en: "Xiao", ko: "", ja: "" }, 
                    artist: "Sajoy", pen: "Sajoyvy", 
                    role: { en: "Hamhampangpang food tester", ko: " ", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291865241030881/thetower.png?ex=695b784f&is=695a26cf&hm=75515b87aab92e64d76b202c6ce61884baf4b8947e16bb93a30baf9bbd76e7cc&=&format=webp&quality=lossless&width=621&height=888", 
                    socials: { twitter: "https://x.com/Zukinan_" } 
                },
                { 
                    cardId: 16, no: "16", card: "The Tower", 
                    char: { en: "Haehwan", ko: "", ja: "" }, 
                    artist: "Poyo", pen: "minialily", 
                    role: { en: "Moon light bird", ko: " ", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291874514767893/thetower1.png?ex=695b7852&is=695a26d2&hm=bca01d9bda85df7dd3c88f37cd5b24a29f7a15134e5940c07ae1878b2161e837&=&format=webp&quality=lossless&width=623&height=888", 
                    socials: { twitter: "https://x.com/minialily" } 
                },
                
                // XVII. THE STAR
                { 
                    cardId: 17, no: "17", card: "The Star", 
                    char: { en: "Don", ko: "", ja: "" }, 
                    artist: "Wenli", pen: "eyesbuttered", 
                    role: { en: "The only grade 10 fixer", ko: " 10 ", ja: "10" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291847507644416/thestar.png?ex=695b784b&is=695a26cb&hm=2aefbbe0ee3080d01261d2129d6350f9e91e03317ea1d41070fe3c02f6fb47a4&=&format=webp&quality=lossless&width=621&height=888", 
                    socials: { instagram: "https://instagram.com/eyesbuttered" } 
                },
                
                // XVIII. THE MOON (Variants)
                { 
                    cardId: 18, no: "18", card: "The Moon", 
                    char: { en: "Rodion", ko: "", ja: "" }, 
                    artist: "Laser", pen: "Laser", 
                    role: { en: "Mysterious Intern", ko: " ", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291828171640958/themoon.png?ex=695b7847&is=695a26c7&hm=80e9554561c3d45d8fdabb3b6070d891c3b85a55780e60db40602a702f691c6f&=&format=webp&quality=lossless&width=621&height=887", 
                    socials: { twitter: "https://x.com/Juemingziwww" } 
                },
                { 
                    cardId: 18, no: "18", card: "The Moon", 
                    char: { en: "Torino", ko: "", ja: "" }, 
                    artist: "Muta", pen: "myonkill", 
                    role: { en: "Unknown", ko: "", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291836908638391/themoon1.png?ex=695b7849&is=695a26c9&hm=ec8b83ac9e3ee9a168675f359bfd9ee6e48ef909e03e2ec583f7f9428fb9461d&=&format=webp&quality=lossless&width=621&height=887", 
                    socials: { twitter: "https://x.com/myonkill" } 
                },
                
                // XIX. THE SUN
                { 
                    cardId: 19, no: "19", card: "The Sun", 
                    char: { en: "Ishmeal", ko: "", ja: "" }, 
                    artist: "Accio", pen: "urchinspines", 
                    role: { en: "The ring pontilist student", ko: "  ", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291855598325843/thesun.png?ex=695b784d&is=695a26cd&hm=897cd5e84e86da12ce7c41975f8c4b87850d115adaeab675f7aff5bc32bb3190&=&format=webp&quality=lossless&width=621&height=888", 
                    socials: { twitter: "https://x.com/kamiyamahigh" } 
                },
                
                // XX. JUDGEMENT (Variants)
                { 
                    cardId: 20, no: "20", card: "Judgment", 
                    char: { en: "Sinclair", ko: "", ja: "" }, 
                    artist: "Nori", pen: "Nor1san23", 
                    role: { en: "LCE", ko: "LCE", ja: "LCE" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291614522310743/judgement.png?ex=695b7814&is=695a2694&hm=0a7d33974a526bd7ced496e466436364601b63385ad2b76b368e3a71f94e2ba7&=&format=webp&quality=lossless&width=621&height=888", 
                    socials: { twitter: "https://x.com/Nor1san23" } 
                },
                { 
                    cardId: 20, no: "20", card: "Judgement", 
                    char: { en: "Binah", ko: "", ja: "" }, 
                    artist: "Tako", pen: "tako0mari", 
                    role: { en: "Arbiter", ko: "", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291624538443957/judgement1.png?ex=695b7816&is=695a2696&hm=0e32fe853cc2fea810bdaa142c365532f8934a3e140e11671a9f5149426db288&=&format=webp&quality=lossless&width=621&height=888", 
                    socials: { twitter: "https://x.com/tako0mari" } 
                },
                { 
                    cardId: 20, no: "20", card: "Judgment", 
                    char: { en: "Purple Girl", ko: " ", ja: "" }, 
                    artist: "Ooya", pen: "OOYA", 
                    role: { en: "Milk delivery person", ko: " ", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291633044488349/judgment2.png?ex=695b7818&is=695a2698&hm=ec83bde951acdac9345b5c7110eefea559d5d7802d272584105305ae996cb194&=&format=webp&quality=lossless&width=621&height=888", 
                    socials: { twitter: "https://x.com/July_26_" } 
                },
                
                // XXI. THE WORLD
                { 
                    cardId: 21, no: "21", card: "The World", 
                    char: { en: "Excalibur", ko: "", ja: "" }, 
                    artist: "Rou Rou", pen: "RouRou", 
                    role: { en: "Florist", ko: "", ja: "" }, 
                    variantImage: "https://media.discordapp.net/attachments/1457280504758800384/1457291883305762868/theworld.png?ex=695b7854&is=695a26d4&hm=3d593799c65280890c5de9a1e69dbeb45a7c8df00c4b8398508a858bc1af2645&=&format=webp&quality=lossless&width=621&height=888", 
                    socials: { twitter: "https://x.com/rousheep" } 
                }
            ],
        };

        // --- UTILITIES ---
        const LazyLoader = {
            observer: null,
            init() {
                if ('IntersectionObserver' in window) {
                    this.observer = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                this.load(entry.target);
                                this.observer.unobserve(entry.target);
                            }
                        });
                    });
                }
            },
            observe() {
                document.querySelectorAll('img.lazy-img').forEach(img => {
                    if (this.observer) this.observer.observe(img);
                    else this.load(img);
                });
            },
            load(img) {
                if(img.dataset.src) {
                    img.src = img.dataset.src;
                    img.onload = () => img.classList.add('img-loaded');
                }
            }
        };

        const AudioManager = {
            ctx: null,
            gain: null,
            init() {
                try {
                    window.AudioContext = window.AudioContext || window.webkitAudioContext;
                    this.ctx = new AudioContext();
                    this.gain = this.ctx.createGain();
                    this.gain.connect(this.ctx.destination);
                } catch (e) {
                    console.warn("Audio Context blocked or failed", e);
                }
            },
            play(type) {
                if (!this.ctx) this.init();
                if (!this.ctx) return;
                if (this.ctx.state === 'suspended') this.ctx.resume().catch(() => {});
                
                try {
                    const osc = this.ctx.createOscillator();
                    const g = this.ctx.createGain();
                    osc.connect(g);
                    g.connect(this.gain);

                    const now = this.ctx.currentTime;
                    
                    if (type === 'click') {
                        osc.type = 'sine';
                        osc.frequency.setValueAtTime(800, now);
                        osc.frequency.exponentialRampToValueAtTime(300, now + 0.1);
                        g.gain.setValueAtTime(0.1, now);
                        g.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
                        osc.start(now);
                        osc.stop(now + 0.1);
                    } else if (type === 'hover') {
                        osc.type = 'triangle';
                        osc.frequency.setValueAtTime(200, now);
                        g.gain.setValueAtTime(0.05, now);
                        g.gain.linearRampToValueAtTime(0, now + 0.05);
                        osc.start(now);
                        osc.stop(now + 0.05);
                    } else if (type === 'login') {
                        osc.type = 'square';
                        osc.frequency.setValueAtTime(200, now);
                        osc.frequency.linearRampToValueAtTime(800, now + 0.3);
                        g.gain.setValueAtTime(0.1, now);
                        g.gain.linearRampToValueAtTime(0, now + 1.0);
                        osc.start(now);
                        osc.stop(now + 1.0);
                    } else if (type === 'open') {
                        osc.type = 'sine';
                        osc.frequency.setValueAtTime(400, now);
                        osc.frequency.exponentialRampToValueAtTime(600, now + 0.2);
                        g.gain.setValueAtTime(0.1, now);
                        g.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
                        osc.start(now);
                        osc.stop(now + 0.3);
                    } else if (type === 'meow') {
                        // Synth Meow: Triangle wave sweeping up then down
                        osc.type = 'triangle';
                        osc.frequency.setValueAtTime(800, now);
                        osc.frequency.linearRampToValueAtTime(1200, now + 0.1);
                        osc.frequency.exponentialRampToValueAtTime(600, now + 0.4);
                        g.gain.setValueAtTime(0.1, now);
                        g.gain.linearRampToValueAtTime(0, now + 0.4);
                        osc.start(now);
                        osc.stop(now + 0.4);
                    } else if (type === 'hiss') {
                        // Synth Hiss: Sawtooth wave descending quickly
                        osc.type = 'sawtooth';
                        osc.frequency.setValueAtTime(800, now);
                        osc.frequency.exponentialRampToValueAtTime(100, now + 0.3);
                        g.gain.setValueAtTime(0.1, now);
                        g.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
                        osc.start(now);
                        osc.stop(now + 0.3);
                    }
                } catch(e) { console.warn("Audio play failed", e); }
            },
            toggle() {}, next() {}, prev() {}
        };

        const WindowManager = {
            zIndex: 100,
            maximizedState: {},
            open(id) {
                const win = document.getElementById(id);
                if(win) {
                    win.style.display = 'flex';
                    this.bringToFront(win);
                    win.classList.remove('minimized');
                    // Small delay to allow display:flex to apply before adding class for transition
                    requestAnimationFrame(() => {
                        win.classList.add('window-open');
                    });
                    AudioManager.play('open');
                    if (window.lucide) lucide.createIcons({ root: win });
                }
            },
            close(id) {
                const win = document.getElementById(id);
                if(win) {
                    win.classList.remove('window-open', 'active', 'minimized');
                    // Wait for transition to finish before hiding
                    setTimeout(() => {
                        win.style.display = 'none';
                    }, 300); 
                    AudioManager.play('click');
                }
            },
            minimize(id) {
                const win = document.getElementById(id);
                if(win) {
                    win.classList.add('minimized');
                    win.classList.remove('active');
                    AudioManager.play('click');
                }
            },
            toggleMaximize(id) {
                const win = document.getElementById(id);
                if (!win) return;

                if (win.classList.contains('maximized')) {
                    win.classList.remove('maximized');
                    const state = this.maximizedState[id] || {};
                    win.style.top = state.top || '10%';
                    win.style.left = state.left || '10%';
                    win.style.width = state.width || '600px';
                    win.style.height = state.height || '500px';
                } else {
                    this.maximizedState[id] = {
                        top: win.style.top,
                        left: win.style.left,
                        width: win.style.width,
                        height: win.style.height
                    };
                    win.classList.add('maximized');
                    win.style.top = '70px';
                    win.style.left = '0';
                    win.style.width = '100%';
                    win.style.height = 'calc(100% - 125px)';
                }
                this.bringToFront(win);
                AudioManager.play('click');
            },
            bringToFront(win) {
                this.zIndex++;
                win.style.zIndex = this.zIndex;
                document.querySelectorAll('.os-window').forEach(w => w.classList.remove('active'));
                win.classList.add('active');
            },
            showDesktop() {
                document.querySelectorAll('.os-window').forEach(w => {
                    w.classList.remove('window-open');
                    setTimeout(() => w.style.display = 'none', 300);
                });
                AudioManager.play('click');
            }
        };

        const Viewer3D = {
            state: { scale: 1, rotX: 0, rotY: 0 },
            init() {
                const stage = document.getElementById('viewer-stage');
                if(!stage) return;
                
                // Mouse Events
                stage.addEventListener('mousedown', (e) => this.startDrag(e));
                window.addEventListener('mousemove', (e) => this.drag(e));
                window.addEventListener('mouseup', () => this.endDrag());
                
                // Touch Events (Mobile)
                stage.addEventListener('touchstart', (e) => this.startDrag(e), {passive: false});
                window.addEventListener('touchmove', (e) => this.drag(e), {passive: false});
                window.addEventListener('touchend', () => this.endDrag());

                // Wheel Zoom
                stage.addEventListener('wheel', (e) => {
                    e.preventDefault();
                    const delta = e.deltaY > 0 ? -0.2 : 0.2;
                    this.adjustZoom(delta);
                }, {passive: false});
            },
            reset() {
                this.state = { scale: 1, rotX: 0, rotY: 0 };
                this.updateTransform();
            },
            startDrag(e) {
                // Ignore if clicking control buttons
                if(e.target.closest('button')) return;

                e.preventDefault();
                this.state.isDragging = true;
                
                const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
                const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
                
                this.state.startX = clientX;
                this.state.startY = clientY;
                
                // Store current rotation to add delta to it
                this.state.currentRotX = this.state.rotX;
                this.state.currentRotY = this.state.rotY;
                
                const stage = document.getElementById('viewer-stage');
                if(stage) stage.style.cursor = 'grabbing';
            },
            drag(e) {
                if(!this.state.isDragging) return;
                e.preventDefault();
                
                const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
                const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
                
                const deltaX = clientX - this.state.startX;
                const deltaY = clientY - this.state.startY;
                
                // Update rotation based on movement
                this.state.rotY = this.state.currentRotY + (deltaX * 0.5);
                this.state.rotX = this.state.currentRotX - (deltaY * 0.5);
                
                this.updateTransform();
            },
            endDrag() {
                this.state.isDragging = false;
                const stage = document.getElementById('viewer-stage');
                if(stage) stage.style.cursor = 'grab';
            },
            adjustZoom(delta) {
                let newScale = this.state.scale + delta;
                if (newScale < 0.5) newScale = 0.5;
                if (newScale > 3.0) newScale = 3.0;
                this.state.scale = newScale;
                this.updateTransform();
                AudioManager.play('click');
            },
            updateTransform() {
                const wrapper = document.getElementById('viewer-card-wrapper');
                if (!wrapper) return;
                wrapper.style.transform = `scale(${this.state.scale}) rotateX(${this.state.rotX}deg) rotateY(${this.state.rotY}deg)`;
                const zoomVal = document.getElementById('zoom-val');
                if (zoomVal) zoomVal.innerText = Math.round(this.state.scale * 100) + '%';
            }
        };

        // System / App Logic
        const System = {
            lang: 'en',
            loginTimer: null,
            // Assistant State
            assistantIdx: 0,
            assistantSteps: [], 
            isTutorialComplete: false,
            assistantDragging: false,
            
            // Brief Gallery State
            briefImgIdx: 0,
            briefImages: [
                { 
                    src: "https://media.discordapp.net/attachments/1457280504758800384/1457280757872459963/misson.jpg?ex=695c16b7&is=695ac537&hm=d2e73c757c351f8f5311594475811ac5147642e367484fc54ccb8331681b67db&=&format=webp&width=2645&height=1869",
                    key: "brief_fig_main"
                },
                { 
                    src: "https://media.discordapp.net/attachments/1457280504758800384/1457480080774397962/gallery_1.jpg?ex=695c2799&is=695ad619&hm=e8bdb8818b6d6eb19e2b3bb4e2517fbcfc12034be130575c71bf8f02ecc08b4c&=&format=webp&width=2645&height=1869",
                    key: "brief_fig_a"
                },
                { 
                    src: "https://media.discordapp.net/attachments/1457280504758800384/1457480084653871206/gallery_2.jpg?ex=695c279a&is=695ad61a&hm=0346455eaf170923eda296f9f2e7408c376609d0de998d6038a99d298137e0f4&=&format=webp&width=2645&height=1869",
                    key: "brief_fig_b"
                },
                { 
                    src: "https://media.discordapp.net/attachments/1457280504758800384/1457480258235273406/gallery_1.jpg?ex=695c27c4&is=695ad644&hm=a2f7ddd525a54a5e539922186c9070a8ee75f1fb53bfe1fd3ecefd7147a3a1fe&=&format=webp&width=2645&height=1869",
                    key: "brief_fig_c"
                },
                { 
                    src: "https://media.discordapp.net/attachments/1457280504758800384/1457480272412020736/gallery_3.jpg?ex=695c27c7&is=695ad647&hm=f011e816bea8b1ae71bb31c7d83de063e8507c58c7e9ab80c4259a9b0f91bea7&=&format=webp&width=743&height=525",
                    key: "brief_fig_d"
                }
            ],
            
            // Login State Guard
            isLoggingIn: false,

            init() {
                try {
                    // REMOVED LOADER HIDING HERE - Will do it after a delay
                    
                    AudioManager.init();
                    this.setupDrag(); // Standard window drag
                    this.setupAssistantDrag(); // NEW: OOB Drag
                    this.setupListeners();
                    this.checkMobile(); 
                    Viewer3D.init();
                    window.addEventListener('resize', () => { this.checkMobile(); });
                    this.startAutoLoginTimer();
                    
                    // ... clock loop ...
                    setInterval(() => {
                        document.getElementById('clock').innerText = new Date().toLocaleTimeString('en-US', { hour12: false });
                        const latency = Math.floor(Math.random() * (55 - 24 + 1) + 24);
                        const latEl = document.getElementById('sig-latency');
                        if(latEl) latEl.innerText = latency + "ms";
                        const chars = "ABCDEF0123456789";
                        let hash = "";
                        for(let i=0; i<4; i++) hash += chars.charAt(Math.floor(Math.random() * chars.length));
                        hash += "-";
                        for(let i=0; i<4; i++) hash += chars.charAt(Math.floor(Math.random() * chars.length));
                        const hashEl = document.getElementById('enc-hash-display');
                        if(hashEl) hashEl.innerText = hash;
                        this.updateCountdowns();
                    }, 1000);

                    if(window.lucide) lucide.createIcons();
                    this.renderGrid();
                    this.setLanguage('en');

                    // HIDE LOADER AFTER INIT
                    setTimeout(() => {
                        const loader = document.getElementById('system-loader');
                        if(loader) {
                            loader.style.opacity = '0';
                            setTimeout(() => loader.remove(), 500);
                        }
                    }, 1500); // Wait 1.5s to show loader
                } catch(e) {
                    console.error("System Init Failed:", e);
                }
            },

            updateCountdowns() {
                // ... existing countdown logic ...
                const now = new Date().getTime();
                const labels = DB.TRANSLATIONS[this.lang];
                
                const evt1 = new Date('2026-02-15T11:30:00+09:00').getTime();
                const evt2 = new Date('2026-02-21T12:00:00+09:00').getTime();

                const updateElement = (id, targetTime) => {
                    const el = document.getElementById(id);
                    if(!el) return;
                    
                    const diff = targetTime - now;
                    
                    if (diff < 0) {
                        el.innerText = labels.time_concluded;
                        el.style.color = "#666";
                        el.style.borderColor = "#666";
                        el.style.background = "rgba(0,0,0,0.5)";
                        return;
                    }

                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const mins = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    const secs = Math.floor((diff % (1000 * 60)) / 1000);
                    
                    const p = (n) => n.toString().padStart(2, '0');
                    
                    el.innerText = `${labels.time_tminus}: ${days}${labels.time_days} ${p(hours)}${labels.time_hours} ${p(mins)}${labels.time_mins} ${p(secs)}${labels.time_secs}`;
                };

                updateElement('countdown-1', evt1);
                updateElement('countdown-2', evt2);
            },

            startAutoLoginTimer() {
                const input = document.getElementById('login-input');
                const bar = document.getElementById('auto-login-bar');
                if (!input) return;

                // Reset and Animate Progress Bar
                if (bar) {
                    bar.style.transition = 'none';
                    bar.style.width = '0%';
                    // Force reflow
                    void bar.offsetWidth;
                    bar.style.transition = 'width 5s linear';
                    bar.style.width = '100%';
                }

                this.loginTimer = setTimeout(() => {
                    if (input.value.trim() === '') {
                        this.performAutoFill();
                    }
                }, 5000);
            },

            performAutoFill() {
                const input = document.getElementById('login-input');
                const wrapper = document.getElementById('login-wrapper');
                const bar = document.getElementById('auto-login-bar');
                
                if (!input) return;

                // Hide bar on fill start
                if(bar) bar.style.opacity = '0';

                const code = "DISTORTIONDIVINA";
                let i = 0;
                if(wrapper) wrapper.classList.add('focused');
                const typeInterval = setInterval(() => {
                    if (i < code.length) {
                        input.value += code.charAt(i);
                        i++;
                    } else {
                        clearInterval(typeInterval);
                        setTimeout(() => this.login(), 400);
                    }
                }, 60);
            },

            checkMobile() {
                const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent) || window.innerWidth < 768;
                document.body.classList.toggle('is-mobile', isMobile);
                
                // Auto-enable large UI on mobile if not set manually yet
                // (Optional: can force large mode on mobile init)
                if (isMobile && !document.body.classList.contains('ui-large')) {
                     // Uncomment to default to large on mobile
                     // document.body.classList.add('ui-large');
                }
                
                this.updateModeButtons();
                this.updateScaleButtons(); // Ensure scale buttons are rendered
            },

            toggleMode() {
                document.body.classList.toggle('is-mobile');
                this.updateModeButtons();
                AudioManager.play('click');
            },
            
            toggleUIScale() {
                document.body.classList.toggle('ui-large');
                this.updateScaleButtons();
                AudioManager.play('click');
            },

            updateScaleButtons() {
                const isLarge = document.body.classList.contains('ui-large');
                const labels = DB.TRANSLATIONS[this.lang];
                document.querySelectorAll('.ui-scale-btn').forEach(btn => {
                    btn.innerHTML = isLarge ? `<i data-lucide="zoom-out" width="18"></i> ${labels.btn_scale_normal}` : `<i data-lucide="zoom-in" width="18"></i> ${labels.btn_scale_large}`;
                });
                if(window.lucide) lucide.createIcons();
            },

            updateModeButtons() {
                const isMobile = document.body.classList.contains('is-mobile');
                const labels = DB.TRANSLATIONS[this.lang];
                const btns = document.querySelectorAll('.mode-switch-btn');

                btns.forEach(btn => {
                    if (isMobile) {
                        btn.innerHTML = `<i data-lucide="smartphone" width="18"></i> ${labels.ui_mode_mobile}`;
                    } else {
                        btn.innerHTML = `<i data-lucide="monitor" width="18"></i> ${labels.ui_mode_desktop}`;
                    }
                });
                if (window.lucide) lucide.createIcons();
            },

            setLanguage(lang) {
                this.lang = lang;
                const labels = DB.TRANSLATIONS[lang];
                
                // Update buttons active state
                const targetText = lang === 'en' ? 'en' : (lang === 'ko' ? '' : '');
                document.querySelectorAll('.lang-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.innerText.toLowerCase().includes(targetText)) {
                        btn.classList.add('active');
                    }
                });

                // Update standard i18n text
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (labels[key]) {
                        if (el.children.length === 0) {
                            el.innerText = labels[key];
                        } else {
                            el.innerText = labels[key];
                        }
                    }
                });
                
                // Update Inputs & Placeholders
                const loginInput = document.getElementById('login-input');
                if (loginInput) loginInput.placeholder = labels.login_placeholder;
                
                // Update Brief Caption
                const briefCap = document.getElementById('brief-caption-display');
                if(briefCap) {
                    const imgKey = this.briefImages[this.briefImgIdx].key;
                    if(labels[imgKey]) briefCap.innerText = labels[imgKey];
                }
                
                // Update Dynamic Buttons
                this.updateModeButtons();
                this.updateScaleButtons();
                
                // Update Grid & Employees (re-render for text)
                this.renderGrid();
                this.renderEmployees(); // Ensure this is called
                this.updateCountdowns();
            },
            
            changeBriefImage(dir) {
                // Show loading state on image
                const imgEl = document.getElementById('brief-img-display');
                if(imgEl) {
                    imgEl.style.opacity = '0.3';
                    // Optional: Add spinner overlay here if needed
                }

                this.briefImgIdx += dir;
                if (this.briefImgIdx >= this.briefImages.length) this.briefImgIdx = 0;
                if (this.briefImgIdx < 0) this.briefImgIdx = this.briefImages.length - 1;
                
                const imgData = this.briefImages[this.briefImgIdx];
                const capEl = document.getElementById('brief-caption-display');
                const counterEl = document.getElementById('brief-img-counter');
                
                setTimeout(() => {
                    if (imgEl) {
                        imgEl.src = imgData.src;
                        imgEl.onload = () => { imgEl.style.opacity = '1'; };
                    }
                }, 200);
                
                const labels = DB.TRANSLATIONS[this.lang];
                if (capEl && labels[imgData.key]) {
                    capEl.setAttribute('data-i18n', imgData.key); // Update for lang switches
                    capEl.innerText = labels[imgData.key];
                }
                
                if (counterEl) counterEl.innerText = `[ ${this.briefImgIdx + 1} / ${this.briefImages.length} ]`;
                
                AudioManager.play('click');
            },

            login() {
                // BUG FIX: Prevent double login/window opening
                if (this.isLoggingIn) return;
                this.isLoggingIn = true;

                // Stop auto-login timer if user clicked manually
                if (this.loginTimer) {
                    clearTimeout(this.loginTimer);
                    this.loginTimer = null;
                }

                const input = document.getElementById('login-input');
                const wrapper = document.getElementById('login-wrapper');
                const msg = document.getElementById('login-message');
                const labels = DB.TRANSLATIONS[this.lang];

                wrapper.classList.add('focused');
                msg.style.opacity = '1';
                msg.innerText = labels.login_verifying;
                msg.style.color = "var(--gold-primary)";
                AudioManager.play('login');

                setTimeout(() => {
                    msg.innerText = labels.access_granted;
                    msg.style.color = "var(--terminal-green)";
                    msg.style.textShadow = "0 0 10px var(--terminal-green)";
                    
                    wrapper.style.borderColor = "var(--terminal-green)";
                    input.style.color = "var(--terminal-green)";
                    
                    setTimeout(() => {
                        const login = document.getElementById('login-screen');
                        login.classList.add('zoom-out'); // Trigger exit animation
                        
                        setTimeout(() => {
                            login.style.display = 'none';
                            document.getElementById('desktop-screen').classList.add('active');
                            setTimeout(() => WindowManager.open('win-overview'), 500);
                            this.initAssistant();
                        }, 800); // Wait for transition
                    }, 1000);
                }, 800);
            },

            toggleRotation() {
                document.getElementById('app-container').classList.toggle('rotated');
                AudioManager.play('click');
            },

            setupListeners() {
                // ADDED: Global Click Ripple Listener
                document.addEventListener('click', (e) => {
                    const target = e.target.closest('button, .desktop-icon, .shop-link-btn, .win-btn, .lang-btn, .login-submit-btn, .mobile-btn, .assistant-btn, .archive-btn, .v-btn, .gallery-nav, .variant-card, .task-item');
                    if (target) {
                        const circle = document.createElement("span");
                        const diameter = Math.max(target.clientWidth, target.clientHeight);
                        const radius = diameter / 2;
                        const rect = target.getBoundingClientRect();
                        
                        circle.style.width = circle.style.height = `${diameter}px`;
                        circle.style.left = `${e.clientX - rect.left - radius}px`;
                        circle.style.top = `${e.clientY - rect.top - radius}px`;
                        circle.classList.add("ripple");
                        
                        // Remove old ripples to keep DOM clean
                        const oldRipple = target.getElementsByClassName("ripple")[0];
                        if (oldRipple) oldRipple.remove();
                        
                        target.appendChild(circle);
                    }
                });

                const loginInput = document.getElementById('login-input');
                if(loginInput) {
                    loginInput.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter') {
                            System.login();
                        }
                    });
                    loginInput.addEventListener('input', () => {
                        if (this.loginTimer) {
                            clearTimeout(this.loginTimer);
                            this.loginTimer = null;
                            // Reset Progress Bar on user input
                            const bar = document.getElementById('auto-login-bar');
                            if(bar) {
                                bar.style.transition = 'none';
                                bar.style.width = '0%';
                                bar.style.opacity = '0';
                            }
                        }
                    });
                    loginInput.focus();
                    loginInput.addEventListener('focus', () => {
                        document.getElementById('login-wrapper').classList.add('focused');
                    });
                    loginInput.addEventListener('blur', () => {
                        document.getElementById('login-wrapper').classList.remove('focused');
                    });
                }
                
                document.querySelectorAll('.desktop-icon').forEach(icon => {
                    const winId = icon.getAttribute('data-window');
                    if(winId) { // Only add listener if it has a window target (Assistant is handled inline)
                        const open = () => WindowManager.open(winId);
                        icon.onclick = open;
                        icon.onkeydown = (e) => { if(e.key==='Enter'||e.key===' ') open(); };
                        icon.onmouseenter = () => AudioManager.play('hover');
                    }
                });

                document.querySelectorAll('.os-window').forEach(win => {
                    win.addEventListener('mousedown', () => WindowManager.bringToFront(win));
                });
                
                // GLOBAL RIPPLE LISTENER
                document.addEventListener('click', (e) => {
                    const target = e.target.closest('button, .desktop-icon, .shop-link-btn, .lang-btn, .assistant-btn');
                    if(target) {
                        const circle = document.createElement('span');
                        const diameter = Math.max(target.clientWidth, target.clientHeight);
                        const radius = diameter / 2;
                        
                        // Get click pos relative to element
                        const rect = target.getBoundingClientRect();
                        const x = e.clientX - rect.left;
                        const y = e.clientY - rect.top;
                        
                        circle.style.width = circle.style.height = `${diameter}px`;
                        circle.style.left = `${x - radius}px`;
                        circle.style.top = `${y - radius}px`;
                        circle.classList.add('ripple');
                        
                        const ripple = target.getElementsByClassName('ripple')[0];
                        if (ripple) {
                            ripple.remove();
                        }
                        
                        target.appendChild(circle);
                    }
                });
            },

            setupDrag() {
                let isDragging = false;
                let currentWindow = null;
                let dragOffsetX = 0;
                let dragOffsetY = 0;
                let targetX = 0;
                let targetY = 0;
                let isFrameRequested = false;
                
                // Bounds constraints
                let minX = 0, maxX = 0, minY = 0, maxY = 0;

                const start = (e) => {
                    // REMOVED 'is-mobile' check to allow dragging on mobile
                    if (e.target.closest('.win-controls')) return;
                    // Prevent drag if clicking content buttons
                    if (e.target.closest('button') || e.target.closest('.archive-btn')) return;
                    
                    const win = e.target.closest('.os-window');
                    if (!win || !e.target.closest('.window-header')) return;

                    isDragging = true;
                    currentWindow = win;
                    WindowManager.bringToFront(win);
                    
                    const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
                    const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
                    const rect = win.getBoundingClientRect();
                    dragOffsetX = clientX - rect.left;
                    dragOffsetY = clientY - rect.top;
                    
                    // Calculate Bounds (Keep at least 50px visible)
                    const screenW = window.innerWidth;
                    const screenH = window.innerHeight;
                    const winW = rect.width;
                    
                    minX = 50 - winW; 
                    maxX = screenW - 50; 
                    minY = 70; 
                    maxY = screenH - 50; 
                    
                    AudioManager.play('click');
                };

                const updatePosition = () => {
                    if (!currentWindow || !isDragging) {
                        isFrameRequested = false;
                        return;
                    }
                    
                    // Apply clamping
                    let finalX = Math.max(minX, Math.min(targetX, maxX));
                    let finalY = Math.max(minY, Math.min(targetY, maxY));
                    
                    currentWindow.style.left = finalX + 'px';
                    currentWindow.style.top = finalY + 'px';
                    isFrameRequested = false;
                };

                const move = (e) => {
                    if (!isDragging || !currentWindow) return;
                    e.preventDefault();
                    const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
                    const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
                    
                    targetX = clientX - dragOffsetX;
                    targetY = clientY - dragOffsetY;
                    
                    if (!isFrameRequested) {
                        isFrameRequested = true;
                        requestAnimationFrame(updatePosition);
                    }
                };

                const end = () => { isDragging = false; currentWindow = null; isFrameRequested = false; };

                document.addEventListener('mousedown', start);
                document.addEventListener('touchstart', start, {passive: false});
                document.addEventListener('mousemove', move);
                document.addEventListener('touchmove', move, {passive: false});
                document.addEventListener('mouseup', end);
                document.addEventListener('touchend', end);
            },

            setupAssistantDrag() {
                const overlay = document.getElementById('assistant-overlay');
                const avatar = overlay ? overlay.querySelector('.assistant-avatar') : null;
                const bubble = overlay ? overlay.querySelector('.assistant-bubble') : null;
                
                if (!avatar || !overlay) return;

                let startX = 0, startY = 0, initialLeft = 0, initialTop = 0;
                let hasMoved = false;

                const start = (e) => {
                    e.preventDefault();
                    this.assistantDragging = true;
                    hasMoved = false;
                    
                    const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
                    const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
                    
                    const rect = overlay.getBoundingClientRect();
                    // On first drag, we convert fixed positioning to absolute/fixed coords based on current spot
                    // to allow free movement.
                    overlay.style.bottom = 'auto';
                    overlay.style.right = 'auto';
                    overlay.style.left = rect.left + 'px';
                    overlay.style.top = rect.top + 'px';

                    startX = clientX;
                    startY = clientY;
                    initialLeft = rect.left;
                    initialTop = rect.top;
                    
                    // Hiss on grab/shift start
                    AudioManager.play('hiss');
                    this.setAssistantText(DB.TRANSLATIONS[this.lang].cat_hiss);
                    if(bubble) bubble.style.borderColor = 'var(--glitch-red)';
                };

                const move = (e) => {
                    if (!this.assistantDragging) return;
                    e.preventDefault();
                    hasMoved = true;
                    
                    const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
                    const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
                    
                    const deltaX = clientX - startX;
                    const deltaY = clientY - startY;
                    
                    overlay.style.left = (initialLeft + deltaX) + 'px';
                    overlay.style.top = (initialTop + deltaY) + 'px';
                };

                const end = (e) => {
                    if (!this.assistantDragging) return;
                    this.assistantDragging = false;
                    if(bubble) bubble.style.borderColor = 'var(--gold-primary)';
                    
                    // If simply clicked (not dragged), treat as interaction
                    if (!hasMoved) {
                        this.handleAssistantClick();
                    } else {
                        // After dragging (shifting), maybe return to normal state or say something
                        setTimeout(() => {
                            if(this.isTutorialComplete) this.setAssistantText(this.getRandomCatLine());
                        }, 1000);
                    }
                };

                avatar.addEventListener('mousedown', start);
                avatar.addEventListener('touchstart', start, {passive: false});
                
                window.addEventListener('mousemove', move);
                window.addEventListener('touchmove', move, {passive: false});
                
                window.addEventListener('mouseup', end);
                window.addEventListener('touchend', end);
            },

            handleAssistantClick() {
                AudioManager.play('meow');
                
                if (this.isTutorialComplete) {
                    // Random cat line
                    this.setAssistantText(this.getRandomCatLine());
                } else {
                    // Advance tutorial if clicked during tutorial (optional, but requested behavior implies drag/click distinct)
                    // If user clicks, maybe just meow. Tutorial advance is via button.
                    this.setAssistantText(DB.TRANSLATIONS[this.lang].cat_meow);
                }
                
                // Animation trigger
                const avatar = document.querySelector('.assistant-avatar');
                if(avatar) {
                    avatar.classList.add('talking');
                    setTimeout(() => avatar.classList.remove('talking'), 500);
                }
            },

            getRandomCatLine() {
                const lines = DB.TRANSLATIONS[this.lang].cat_lines || ["Meow."];
                return lines[Math.floor(Math.random() * lines.length)];
            },

            setAssistantText(msg) {
                const text = document.getElementById('assistant-text');
                if(text) text.innerText = msg;
            },

            initAssistant() {
                setTimeout(() => {
                    this.openAssistant();
                }, 2000);
            },

            openAssistant() {
                const overlay = document.getElementById('assistant-overlay');
                const controls = document.querySelector('.assistant-controls');
                
                if(overlay) {
                    overlay.classList.add('active');
                    AudioManager.play('open');
                    
                    if (this.isTutorialComplete) {
                        // Show random idle line, hide Next button if done
                        this.setAssistantText(this.getRandomCatLine());
                        if(controls) controls.style.display = 'none'; // Minimal UI for cat mode
                    } else {
                        // Start Tutorial
                        this.assistantIdx = 0;
                        this.assistantSteps = DB.TRANSLATIONS[this.lang].assistant_steps;
                        this.setAssistantText(this.assistantSteps[0]);
                        if(controls) controls.style.display = 'flex';
                    }
                }
            },

            nextAssistantStep() {
                this.assistantIdx++;
                const controls = document.querySelector('.assistant-controls');
                this.assistantSteps = DB.TRANSLATIONS[this.lang].assistant_steps;
                
                if (this.assistantIdx < this.assistantSteps.length) {
                    this.setAssistantText(this.assistantSteps[this.assistantIdx]);
                    AudioManager.play('click');
                } else {
                    // Tutorial Done -> Switch to Cat Mode
                    this.isTutorialComplete = true;
                    this.setAssistantText(this.getRandomCatLine());
                    if(controls) controls.style.display = 'none'; // Hide buttons, pure cat mode now
                    AudioManager.play('meow');
                }
            },

            closeAssistant() {
                const overlay = document.getElementById('assistant-overlay');
                if(overlay) overlay.classList.remove('active');
                AudioManager.play('click');
            },

            renderGrid(sortType = 'id', clickedBtn = null) {
                const grid = document.getElementById('cardGrid');
                if(!grid) return;
                
                // Show skeletons first
                grid.innerHTML = '';
                for(let i=0; i<8; i++) {
                    grid.innerHTML += `<div class="card-file skeleton" style="height:350px; border:none; background:rgba(255,255,255,0.02)"></div>`;
                }

                // Update active button state if button passed
                if(clickedBtn) {
                    document.querySelectorAll('.archive-btn').forEach(b => b.classList.remove('active'));
                    clickedBtn.classList.add('active');
                    AudioManager.play('click');
                }

                // Create a copy to sort
                let cards = [...DB.CARDS];
                
                if (sortType === 'name') {
                    cards.sort((a,b) => {
                        const nameA = a.title[this.lang] || a.title['en'];
                        const nameB = b.title[this.lang] || b.title['en'];
                        return nameA.localeCompare(nameB);
                    });
                } else {
                    // Default ID sort (Tarot Order)
                    cards.sort((a,b) => a.id - b.id);
                }

                // Simulate brief loading delay
                setTimeout(() => {
                    grid.innerHTML = '';
                    cards.forEach(card => {
                        const el = document.createElement('div');
                        el.className = 'card-file';
                        el.tabIndex = 0;
                        el.role = 'button';
                        
                        el.innerHTML = `
                            <img src="${card.image}" class="img-loading" loading="lazy" onload="this.classList.add('img-loaded')" onerror="this.src='https://placehold.co/400x600/000/333?text=ERR'">
                            <div class="file-label">${card.title[this.lang]}</div>
                        `;
                        const action = () => { this.openSelector(card); AudioManager.play('click'); };
                        el.onclick = action;
                        el.onkeydown = (e) => { if(e.key==='Enter'||e.key===' ') action(); };
                        el.onmouseenter = () => AudioManager.play('hover');
                        grid.appendChild(el);
                    });
                }, 600); // 600ms simulated load
            },

            renderEmployees() {
                const tbody = document.getElementById('employee-list-body');
                tbody.innerHTML = '';
                DB.EMPLOYEES.forEach(emp => {
                    const parentCard = DB.CARDS.find(c => c.id === emp.cardId);
                    let title = emp.card;
                    if (parentCard && parentCard.title[this.lang]) {
                        const parts = parentCard.title[this.lang].split('. ');
                        title = parts.length > 1 ? parts[1] : parentCard.title[this.lang];
                    }

                    const tr = document.createElement('tr');
                    const labels = DB.TRANSLATIONS[this.lang]; 
                    
                    // NEW: Use localized char and role
                    const charName = emp.char[this.lang] || emp.char['en'];
                    const roleName = emp.role[this.lang] || emp.role['en'];

                    tr.innerHTML = `
                        <td class="col-no" data-label="${labels.th_no}">${emp.no}</td>
                        <td class="col-card" data-label="${labels.th_card}">${title}</td>
                        <td class="col-char" data-label="${labels.th_char}">${charName}</td>
                        <td class="col-emp" data-label="${labels.th_emp}">${emp.artist}</td>
                        <td class="col-pen" data-label="${labels.th_pen}">${emp.pen}</td>
                        <td data-label="${labels.th_role}"><span class="role-badge">${roleName}</span></td>
                    `;
                    tbody.appendChild(tr);
                });
            },

            openSelector(card) {
                const variants = DB.EMPLOYEES.filter(e => e.cardId === card.id);
                const labels = DB.TRANSLATIONS[this.lang];

                if (variants.length > 1) {
                    const grid = document.getElementById('selector-grid');
                    grid.innerHTML = '';
                    document.getElementById('selector-title').innerText = `${labels.selector_prefix} ${card.title[this.lang]}`;

                    variants.forEach(v => {
                        const div = document.createElement('div');
                        div.className = 'variant-card';
                        div.tabIndex = 0;
                        div.role = 'button';
                        
                        const img = v.variantImage || card.image;
                        // NEW: Localized char name
                        const charName = v.char[this.lang] || v.char['en'];
                        
                        div.innerHTML = `
                            <div class="variant-img-box"><img src="${img}" onerror="this.src='https://placehold.co/400x600/000/333?text=ERR'"></div>
                            <div class="variant-info">
                                <div class="variant-char">${charName}</div>
                                <div class="variant-artist">ARTIST: ${v.artist}</div>
                            </div>
                        `;
                        const act = () => { this.openViewer(card, v); AudioManager.play('click'); };
                        div.onclick = act;
                        div.onkeydown = (e) => { if(e.key==='Enter'||e.key===' ') act(); };
                        div.onmouseenter = () => AudioManager.play('hover');
                        grid.appendChild(div);
                    });
                    WindowManager.open('win-selector');
                } else if (variants.length === 1) {
                    this.openViewer(card, variants[0]);
                } else {
                    this.openViewer(card, null);
                }
            },

            openViewer(card, variant) {
                Viewer3D.reset();
                const labels = DB.TRANSLATIONS[this.lang];
                const loader = document.getElementById('viewer-loader');
                loader.style.display = 'block';
                
                const imgEl = document.getElementById('viewer-img');
                imgEl.style.opacity = '0';
                
                let src = card.image;
                if (variant && variant.variantImage) src = variant.variantImage;
                
                imgEl.src = src;
                imgEl.onload = () => { 
                    loader.style.display = 'none'; 
                    imgEl.style.opacity = '1'; 
                };

                document.getElementById('viewer-title').innerText = card.title[this.lang];
                document.getElementById('viewer-desc').innerText = card.description[this.lang];
                document.getElementById('viewer-id').innerText = `00${card.id}-ALPHA`;

                const artistDiv = document.getElementById('viewer-artist');
                if (variant) {
                    // NEW: Localized char name
                    const charName = variant.char[this.lang] || variant.char['en'];
                    
                    artistDiv.innerHTML = `
                        <div style="margin-bottom: 20px; border-left: 2px solid var(--gold-primary); padding-left: 15px;">
                            <div style="color: var(--terminal-green); font-size: 0.9rem; text-transform: uppercase; margin-bottom: 6px;">${labels.viewer_char_label}</div>
                            <div style="color: white; font-size: 1.8rem; font-weight: bold; margin-bottom: 12px; font-family: 'Cinzel';">${charName}</div>
                            <div style="color: var(--gold-dim); font-size: 0.8rem; text-transform: uppercase; margin-bottom: 4px;">${labels.viewer_illus_label}</div>
                            <div style="color: #ddd; font-size: 1.3rem; margin-bottom: 6px;">${variant.artist}</div>
                            <div style="color: #888; font-size: 0.95rem; font-family: 'Share Tech Mono';">@${variant.pen}</div>
                        </div>
                    `;
                } else {
                    artistDiv.innerHTML = `<div style="color:#888;">${labels.viewer_no_variant}</div>`;
                }

                const socials = document.getElementById('viewer-socials');
                socials.innerHTML = '';
                const displaySocials = (variant && variant.socials) ? variant.socials : card.socials;

                if(displaySocials) {
                    Object.entries(displaySocials).forEach(([k,v]) => {
                        const a = document.createElement('a');
                        a.href = v; 
                        a.target = "_blank";
                        a.className = "viewer-social-btn";
                        
                        let iconName = 'globe';
                        let label = 'WEBSITE';

                        if(k==='twitter') { iconName = 'twitter'; label = 'TWITTER / X'; }
                        if(k==='instagram') { iconName = 'instagram'; label = 'INSTAGRAM'; }
                        if(k==='website') { iconName = 'globe'; label = 'WEBSITE'; }
                        
                        a.innerHTML = `<i data-lucide="${iconName}" width="18" height="18"></i> <span>${label}</span>`;
                        socials.appendChild(a);
                    });
                    lucide.createIcons({ root: socials });
                }
                
                WindowManager.open('win-viewer');
            }
        };

        // --- 11. BOOTSTRAP ---
        document.addEventListener('DOMContentLoaded', () => {
            System.init();
        });

    </script>
</body>
</html>
